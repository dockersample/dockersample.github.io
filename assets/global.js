"use strict";function _toConsumableArray(a){if(Array.isArray(a)){for(var b=0,c=Array(a.length);b<a.length;b++)c[b]=a[b];return c}return Array.from(a)}function _asyncToGenerator(a){return function(){var b=a.apply(this,arguments);return new Promise(function(a,c){function d(e,f){try{var g=b[e](f),h=g.value}catch(i){return void c(i)}return g.done?void a(h):Promise.resolve(h).then(function(a){d("next",a)},function(a){d("throw",a)})}return d("next")})}}var _slicedToArray=function(){function a(a,b){var c=[],d=!0,e=!1,f=void 0;try{for(var g,h=a[Symbol.iterator]();!(d=(g=h.next()).done)&&(c.push(g.value),!b||c.length!==b);d=!0);}catch(i){e=!0,f=i}finally{try{!d&&h["return"]&&h["return"]()}finally{if(e)throw f}}return c}return function(b,c){if(Array.isArray(b))return b;if(Symbol.iterator in Object(b))return a(b,c);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(a){return typeof a}:function(a){return a&&"function"==typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a};!function(a){function b(a){if("object"===("undefined"==typeof a?"undefined":_typeof(a)))for(var b in a)f[b]=f[b]||a[b]}for(var c=location.host.includes("apowersoft"),d=c||["airmore","showmore.com","videograbber.net","screenshot.net","lightpdf.com","lightmake.com","reccloud"].some(function(a){return location.hostname.includes(a)}),e=window.apowerConfig||{},f=window.apowerTrans=window.apowerTrans||{},g=Object.keys(window),h=0,i=g.length;i>h;h++){var j=g[h];/^trans(?:\d+|_\w+)?$/.test(j)&&b(window[j])}var k=document.documentElement.lang||a.store.get("lang")||"en";d?(document.documentElement.lang=k,a.store.set("lang",k)):k=f.lang||k;var l=window.apower=window.apower||{isApowerDomain:c,isOurDomain:d,lang:k,translations:f,extendTranslation:b,pageType:e.pageType||"",productId:e.productId||"",productType:e.productType||"1",hash:"406b24353675aac594d2a7c5f6cc31fe",agents:{},isDev:location.hostname.endsWith(".test"),tr:function(a){var b=void 0,c=l.translations;l.lang;a.includes("@@")&&(b=a.slice(0,a.indexOf("@@")),a=a.slice(a.indexOf("@@")+2));for(var d=c[a]||b||a,e=arguments.length,f=Array(e>1?e-1:0),g=1;e>g;g++)f[g-1]=arguments[g];return f.length>0&&(d=d.format(f)),d},trans:function(a){return a=a.replace(/\{([^\{\}]*?)@{1,2}(\w*)(,.+?)?\}/g,function(a,b,c,d){return l._trans_by_matches(b,c,d)}),a=a.replace(/>\s*([^<>]*?)@@(\w*)(,.+?)?\s*</g,function(a,b,c,d){return">"+l._trans_by_matches(b,c,d)+"<"})},_trans_by_matches:function(a,b,c){var d=a,e=b,f=c||"",g=String(l.tr(d+"@@"+e));if(f){f=f.slice(1).split(",");for(var h=0;h<f.length;h++){var i=f[h].trim();i.startsWith("@")&&(i=String(l.tr(i.slice(1)))),f[h]=i}g=g.format(f);for(var j=0;j<f.length;j++){var k=f[j].trim();g.includes(k)||(g+="_"+k)}}return g},getRegionPath:function(a){if(location.hostname.includes("reccloud.cn"))return"";var b=this.getShortRegion(a);return"en"===b?"":"/"+b},getShortRegion:function(a){a=a||l.lang;var b={cs:"cz",da:"dk",ja:"jp",sv:"se",el:"gr"},c=b[a];return c||(c=a),c},getApowersoftDomain:function(a){if(this.isDev)return"zh"===a?"http://apowersoftcn.test":"http://apowersoft.test";a=a||l.lang;var b={pt:".com.br",en:".com",zh:".cn",tr:"-tr.com",no:"-no.com",cs:".cz",da:".dk",ja:".jp",sv:".se",el:".gr"},c="fr de it nl es fi pl tw hu".split(" ");b[a]||c.includes(a)||(a="en");var d=b[a]||"."+a,e=void 0;return e="https://www.apowersoft"+d},getDomain:function(a){if(this.isDev)return"zh"===a?"http://apowersoftcn.test":"http://apowersoft.test";a=a||l.lang;var b={pt:".com.br",en:".com",zh:".cn",tr:"-tr.com",no:"-no.com",cs:".cz",da:".dk",ja:".jp",sv:".se",el:".gr"},c="fr de it nl es fi pl tw hu".split(" ");b[a]||c.includes(a)||(a="en");var d=b[a]||"."+a,e=void 0;return e=window.location.hostname.includes("myaccount.lightmv")?"https://lightmv.com/"+a:"https://www.apowersoft"+d},getCDNDomain:function(a){return this.isDev?"http://apowersoft.test/frontend":location.host.startsWith("dev")?"https://dev048.apowersoft.com":"https://cdn.aoscdn.com"},getSupportDomain:function(){return"https://support.aoscdn.com"},getAPIDomain:function(a){return this.isDev?"http://api.apowersoft.test":"zh"===l.lang?"https://api.apowersoft.cn":"https://api.apowersoft.com"},getWPPath:function(a){if(l.isApowerDomain)return"";var b=l.getRegionPath(a)+"/wp";return b},getDownloadDomain:function(a){switch(a=a||l.lang){case"zh":return"https://download.apowersoft.cn";default:return"https://download.apowersoft.com"}},getMyAccountDomain:function(){return this.isDev?"http://dev050.apowersoft.com":"zh"===l.lang||location.host.endsWith("cn")?"https://myaccount.apowersoft.cn":"https://myaccount.apowersoft.com"},getMyAccountMobileDomain:function(){return this.isDev?"http://myaccountm.apowersoft.test":"zh"===l.lang||location.host.endsWith("cn")?"https://myaccountm.apowersoft.cn":"https://myaccountm.apowersoft.com"},randomString:function(a){a=a||32;for(var b="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnoprstuvwxyz123456789",c=b.length,d="",e=0;a>e;e++)d+=b.charAt(Math.floor(Math.random()*c));return d}},m={uploadFiles:function(){function b(a,b,d){return c.apply(this,arguments)}var c=_asyncToGenerator(regeneratorRuntime.mark(function d(b,c,e){var f,g,h,i,j,k,m,n,o,p;return regeneratorRuntime.wrap(function(d){for(;;)switch(d.prev=d.next){case 0:if(e&&(c=c.bind(e)),b=this.filterFiles(b),b.length){d.next=5;break}return c&&c([]),d.abrupt("return",[]);case 5:return f=!1,a.msg.info(l.tr("Uploading {0}...@@uploading_file").format('"'+b[0].name+'"'),"0%",{buttons:["cancel"],handler:function(a){f=!0}}),d.next=9,this.getAttachmentParams(b);case 9:if(g=d.sent,g&&!f){d.next=13;break}return c&&c(null),d.abrupt("return",null);case 13:h=[],i=!0,j=!1,k=void 0,d.prev=17,m=b[Symbol.iterator]();case 19:if(i=(n=m.next()).done){d.next=33;break}return o=n.value,d.next=23,this.uploadEachFile(o,g(h.length));case 23:if(p=d.sent,!p){d.next=28;break}h.push({url:p,name:o.name}),d.next=30;break;case 28:return c&&c(null),d.abrupt("return",null);case 30:i=!0,d.next=19;break;case 33:d.next=39;break;case 35:d.prev=35,d.t0=d["catch"](17),j=!0,k=d.t0;case 39:d.prev=39,d.prev=40,!i&&m["return"]&&m["return"]();case 42:if(d.prev=42,!j){d.next=45;break}throw k;case 45:return d.finish(42);case 46:return d.finish(39);case 47:return c&&c(h),d.abrupt("return",h);case 49:case"end":return d.stop()}},d,this,[[17,35,39,47],[40,,42,46]])}));return b}(),uploadFile:function(){function a(a,c,d){return b.apply(this,arguments)}var b=_asyncToGenerator(regeneratorRuntime.mark(function c(a,b,d){var e,f;return regeneratorRuntime.wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return d&&(b=b.bind(d)),c.next=3,this.uploadFiles([a]);case 3:return e=c.sent,f=e?e[0]:null,b&&b(f),c.abrupt("return",f);case 7:case"end":return c.stop()}},c,this)}));return a}(),filterFiles:function(b){var c=void 0;return b=[].concat(_toConsumableArray(b)).filter(function(a){return c=a.name.replace("/(w+)./",""),!a.name.match(/\.(html|htm|css|php|js)/i)}),!b.length&&c&&a.msg.alert(l.tr("cant_upload_ext_type").format("<b>"+c+"</b>")),b},getAttachmentParams:function(){function a(a){return b.apply(this,arguments)}var b=_asyncToGenerator(regeneratorRuntime.mark(function c(a){var b,d,e,f,g;return regeneratorRuntime.wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return b=a.map(function(a){return a.name}),d={type:"attachment",files:JSON.stringify(b)},c.next=4,this.getParams(d);case 4:if(e=c.sent){c.next=7;break}return c.abrupt("return",null);case 7:return f=e.data.storage,g={callbackUrl:f.callback_url.callbackUrl,callbackBody:f.callback_url.callbackBody},c.abrupt("return",function(a){return{type:f.type,callback_url:JSON.stringify(g),object:f.objects[a],security_token:f.security_token}});case 10:case"end":return c.stop()}},c,this)}));return a}(),getParams:function(){function b(a){return c.apply(this,arguments)}var c=_asyncToGenerator(regeneratorRuntime.mark(function d(b){var c,e,f;return regeneratorRuntime.wrap(function(d){for(;;)switch(d.prev=d.next){case 0:return d.next=2,a.req.post("https://file.aoscdn.com/api/authorize",b);case 2:if(c=d.sent,e=c.ok,f=c.data,!e){d.next=9;break}return d.abrupt("return",f);case 9:return d.abrupt("return",null);case 10:case"end":return d.stop()}},d,this)}));return b}(),uploadEachFile:function(){function b(a,b){return c.apply(this,arguments)}var c=_asyncToGenerator(regeneratorRuntime.mark(function d(b,c){var e,f,g,h,i,j,k,m;return regeneratorRuntime.wrap(function(d){for(;;)switch(d.prev=d.next){case 0:e=new FormData,e.append("file",b);for(f in c)e.append(f,c[f]);return g=function(a){var b=Math.round(a.loaded/a.total*100);i(b)},h=void 0,i=function(c){a.msg.info(l.tr("Uploading {0}...@@uploading_file").format('"'+b.name+'"'),c+"%",{buttons:["cancel"],handler:function(a){h&&h()}})},i(0),d.next=9,a.req.post("https://storage.aoscdn.com/api/files",e,{onuploadprogress:g,getAbort:function(a){h=a}});case 9:if(j=d.sent,k=j.ok,m=j.data,a.msg.hide(),!k||!m){d.next=17;break}return d.abrupt("return",m.data.url);case 17:return a.msg.error(l.tr('Failed to upload "{0}"!@@failed_to_upload',b.name)),d.abrupt("return",null);case 19:case"end":return d.stop()}},d,this)}));return b}(),scriptLoadPromise:null,MAX_AVATAR_SIZE:5242880,uploadAvatar:function(b,c,d){var e=this;return d&&(c=c.bind(d)),b.size>this.MAX_AVATAR_SIZE?(a.msg.alert(l.tr("cant_upload_files_larger").format(a.formatSize(this.MAX_AVATAR_SIZE))),c&&c(null),null):new Promise(function(){var d=_asyncToGenerator(regeneratorRuntime.mark(function f(d){var g,h,i,j,k,m,n,o,p,q,r;return regeneratorRuntime.wrap(function(f){for(;;)switch(f.prev=f.next){case 0:if(window.OSS){f.next=14;break}if(f.prev=1,!e.scriptLoadPromise){f.next=7;break}return f.next=5,e.scriptLoadPromise;case 5:f.next=9;break;case 7:return f.next=9,e.scriptLoadPromise=a.loadScript("https://gosspublic.alicdn.com/aliyun-oss-sdk.min.js");case 9:f.next=14;break;case 11:return f.prev=11,f.t0=f["catch"](1),f.abrupt("return",null);case 14:return g=l.user?l.user.getId():"",h=l.user?l.user.getToken():"",i={type:"avatar",file:b.name,user_id:g,identity_token:h},f.next=19,e.getParams(i);case 19:if(j=f.sent){f.next=22;break}return f.abrupt("return",null);case 22:k=j.data.ali,m=k.callback_url.callbackUrl,n=k.callback_url.callbackBody,o=new OSS.Wrapper({accessKeyId:k.access_id,accessKeySecret:k.access_secret,bucket:k.bucket,secure:!0,stsToken:k.security_token,endpoint:k.endpoint,region:k.region}),p=k.objects[0],q="&x:uid="+g+"&x:utoken="+encodeURI(h),r={url:m,body:n+q},o.multipartUpload(p,b,{cancelFlag:!0,callback:r}).then(function(a){c&&c(a.data.data.url),d(a.data.data.url)},function(a){c&&c(null),d(null)});case 30:case"end":return f.stop()}},f,e,[[1,11]])}));return function(a){return d.apply(this,arguments)}}())}};l.uploadFiles=m.uploadFiles.bind(m),l.uploadFile=m.uploadFile.bind(m),l.uploadAvatar=m.uploadAvatar.bind(m)}(jQuery),function(a){var b=apower,c=b.tr;a.registerDirective("render-on",{value:"",bind:function(){("mobile"===this.value&&a(window).width()<=768||"pc"===this.value&&a(window).width()>768)&&this.layout()},layout:function(){this.el.replaceWith(a(this.el[0].textContent))}}),a.registerDirective("tip",{value:"",align:"t",gap:"5",tipClass:"",bind:function(){this.el.on("mouseenter",this.onMouseEnter,this)},unbind:function(){var a=this;this.el.off("mouseenter",this.onMouseEnter,this),this.el.off("mouseleave",this.onMouseLeave,this),this.layer&&this.layer.fadeOut(200,function(){a.layer.remove()})},update:function(a){this.value=a},onMouseEnter:function(){this.value&&a(window).width()>=768&&(this.showTip(),a.onceAllLeave([this.el,this.layer],200,this.onMouseLeave,this))},showTip:function(){a(".ap-tip").remove(),this.layer=a('<div class="ap-tip '+this.tipClass+'"><div class="ap-trangle"></div><div class="ap-tip-text">'+this.value+"</div></div>").appendTo("body"),this.layer.show(),this.layer.alignTo(this.el,this.align,this.gap),this.trigger("show",this.layer)},onMouseLeave:function(a){this.hideTip()},hideTip:function(){this.el.off("mouseleave",this.onMouseLeave,this),this.layer&&this.layer.fadeOut(300,function(){this.destroyed&&this.layer.remove(),this.trigger("hide",this.layer)}.bind(this))},setValue:function(a){this.value=a,this.layer&&(this.layer.find(".ap-tip-text").html(a),this.layer.alignTo(this.el,this.align,this.gap))}}),a.registerDirective("tabs",{value:"",btns:null,tabs:null,bind:function(){if(this.btns=this.el.children(),this.value){var a=(this.value.startsWith(".")||this.value.startsWith("#")?"":".")+this.value;this.tabs=this.el.findNearestBehind(a).children()}else this.tabs=this.el.next().children();this.btns.$on("click",this.onClickBtn,this);var b=this.btns.filter(".active").index();b>=0&&this.tabs.eq(b).addClass("active")},onClickBtn:function(b){var c=a(b.currentTarget),d=this.tabs.eq(c.index());c.addClass("active").siblings().removeClass("active"),d.addClass("active").siblings().removeClass("active"),this.trigger("change",d)}}),a.registerDirective("loading",{loadingEl:null,update:function(b){var c=this;b?(this.loadingEl=this.loadingEl||a('<div class="loading"><div><div></div></div></div>'),this.loadingEl.appendTo(this.el),"static"===this.el.css("position")&&this.el.css("position","relative"),a.nextTick(function(){c.el.height()<80&&(c.loadingEl.addClass("loading-small"),c.el.css("font-size","0"))})):this.loadingEl&&(this.loadingEl.fadeOut(200,function(){c.loadingEl.hide()}),this.el.css("font-size",""))}}),a.registerMixin("loading",{showLoading:function(){var b=this;this.loadingEl=this.loadingEl||a('<div class="loading"><div><div></div></div></div>').appendTo(this.el),a.nextTick(function(){b.loadingEl.show(),b.el.height()<80?(b.loadingEl.addClass("loading-small"),b.el.css("font-size","0")):b.loadingEl.removeClass("loading-small")})},hideLoading:function(){var a=this;this.loadingEl&&(this.loadingEl.fadeOut(200,function(){a.loadingEl.hide()}),this.el.css("font-size",""))}}),a.registerComponent("icon",{SYMBOLS:{},template:'<svg class="icon" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" :class="\'icon-\' + (type || \'unknown\')"></svg>',type:"",onReady:function(){this.watch("type",this.onTypeChange,!0)},onTypeChange:function(a){this.el.empty();var b=this.SYMBOLS[a],c=this.el[0];if(b){var d=b.matches(/<svg viewBox="(.+?)">([\s\S]+?)<\/svg>/),e=d[1],f=d[2],g=e.split(" "),h=g[2],i=g[3];c.setAttribute("viewBox",e),c.setAttribute("width",h+"px"),c.setAttribute("height",i+"px");var j=document.createElement("div");j.innerHTML="<svg>"+f+"</svg>";for(var k=Array.from(j.childNodes[0].childNodes),l=0,m=k.length;m>l;l++)c.appendChild(k[l])}else c.setAttribute("viewBox","0 0 20 20"),c.setAttribute("width","20px"),c.setAttribute("height","20px")}}),a.getComponent("icon").extendSymbols=function(b){a.extend(a.getComponent("icon").prototype.SYMBOLS,b)},a.getComponent("icon").extendSymbols({down:'		<svg viewBox="0 0 12 12">			<polyline style="stroke-linecap:round;" points="1.5,3.3 6,8.3 10.5,3.3"/>		</svg>	',"down-trangle":'		<svg viewBox="0 0 12 12">			<polygon  points="6.5,0 3.2,4.2 0,0 "/>		</svg>	',search:'		<svg viewBox="0 0 20 20">			<circle style="stroke-miterlimit:10;" cx="8.5" cy="8.5" r="7"/>			<line style="stroke-width:2;stroke-linecap:round;stroke-miterlimit:10;" x1="15.8" y1="15.7" x2="18.5" y2="18.4"/>		</svg>	',"search-thick":'		<svg viewBox="0 0 17 17">			<circle style="stroke-width:2;stroke-linecap:round;stroke-linejoin:round;" cx="7.5" cy="7.5" r="6.5"/>			<line style="stroke-width:2;stroke-linecap:round;stroke-linejoin:round;" x1="14" y1="14" x2="16" y2="16"/>			<path style="stroke-linecap:round;stroke-linejoin:round;" d="M4.5,7c0-1.9,1.6-3.5,3.5-3.5"/>		</svg>	',star:'		<svg viewBox="0 0 22 22">			<path style="fill:currentColor; stroke:none;" d="M19,9.2c-0.1-0.3-0.4-0.5-0.7-0.6L13.8,8l-2-4c-0.2-0.3-0.5-0.5-0.8-0.5c-0.3,0-0.6,0.2-0.8,0.5l-2,4L3.7,8.6C3.4,8.6,3.1,8.9,3,9.2C2.9,9.5,3,9.8,3.3,10l3.2,3.1l-0.8,4.4c-0.1,0.3,0.1,0.6,0.3,0.8c0.3,0.2,0.7,0.3,1,0.1l4-2.1l4,2.1c0.1,0.1,0.3,0.1,0.4,0.1c0.2,0,0.4-0.1,0.5-0.2c0.3-0.2,0.4-0.5,0.3-0.8l-0.8-4.4l3.2-3.1C19,9.8,19.1,9.5,19,9.2z"/>		</svg>	',radio:'		<svg viewBox="0 0 18 18">			<path style="stroke:none; fill:currentColor" d="M12.7,4.3C11,6.6,8.9,9.1,8.1,12c-0.9-1-1.9-2-2.9-2.8c-0.7-0.5-1.6,0.4-0.9,1c1.3,1,2.5,2.3,3.7,3.6c0.3,0.3,1,0.2,1.1-0.3C9.6,10.3,12,7.6,13.9,5C14.4,4.3,13.2,3.6,12.7,4.3"/>		</svg>	',checkbox:'		<svg viewBox="0 0 18 18">			<path style="stroke:none; fill:currentColor" d="M12.7,4.3C11,6.6,8.9,9.1,8.1,12c-0.9-1-1.9-2-2.9-2.8c-0.7-0.5-1.6,0.4-0.9,1c1.3,1,2.5,2.3,3.7,3.6c0.3,0.3,1,0.2,1.1-0.3C9.6,10.3,12,7.6,13.9,5C14.4,4.3,13.2,3.6,12.7,4.3"/>		</svg>	',up:'		<svg viewBox="0 0 10 10">			<polyline style="stroke-linecap:round;stroke-miterlimit:10;" points="9.5,7.3 5,2.3 0.5,7.3"/>		</svg>	',close:'		<svg viewBox="0 0 10 10">			<rect x="4.5" y="-1.5" transform="matrix(0.7071 -0.7071 0.7071 0.7071 -2.0563 4.9852)" style="fill:currentColor;stroke:none;" width="1" height="13"/>			<rect x="-1.5" y="4.5" transform="matrix(0.7071 -0.7071 0.7071 0.7071 -2.0919 5)" style="fill:currentColor;stroke:none;" width="13" height="1"/>		</svg>	',"close-wide":'		<svg viewBox="0 0 12 12">			<line style="stroke-width:2;stroke-linecap:round;stroke-linejoin:round;" x1="1" y1="1" x2="11" y2="11"/>			<line style="stroke-width:2;stroke-linecap:round;stroke-linejoin:round;" x1="11" y1="1" x2="1" y2="11"/>		</svg>	'}),a.registerComponent("radio",{template:'\n		<div class="radio" :class.active="checked" @click="onClick">\n			<div class="radio-icon">\n				<icon type="radio"></icon>\n			</div>\n			<div class="radio-label">\n				<slot></slot>\n			</div>\n		</div>\n	',checked:!1,value:"",onCreated:function(){var a=this.closest("radio-group");a&&(this.group=a,this.checked=a.value==this.value,a.register(this))},onGroupValueChange:function(){var a=this.closest("radio-group");a&&(this.group=a,this.checked=a.value==this.value)},onClick:function(){this.checked||(this.checked=!0,this.trigger("change",this.value))}}),a.registerComponent("radio-group",{template:'\n		<div class="radio-group">\n			<slot></slot>\n		</div>\n	',value:"",onCreated:function(){this.radios=[]},onReady:function(){var a=this;this.watch("value",function(){for(var b=0,c=a.radios.length;c>b;b++)a.radios[b].onGroupValueChange()})},register:function(a){this.radios.push(a),a.on("change",this.onRadioChange.bind(this,a))},onRadioChange:function(a){var b=!0,c=!1,d=void 0;try{for(var e,f=this.radios[Symbol.iterator]();!(b=(e=f.next()).done);b=!0){var g=e.value;g!==a&&(g.checked=!1)}}catch(h){c=!0,d=h}finally{try{!b&&f["return"]&&f["return"]()}finally{if(c)throw d}}this.value=a.value,this.trigger("change",this.value)}}),a.registerComponent("checkbox",{template:'\n		<div class="checkbox" :class.active="checked" @click="onClick">\n			<div class="checkbox-icon">\n				<icon type="checkbox"></icon>\n			</div>\n			<div class="checkbox-label">\n				<slot></slot>\n			</div>\n		</div>\n	',_modelProperty:"checked",checked:!1,value:"",data:null,onCreated:function(){var a=this,b=this.closest("checkbox-group");b&&(this.group=b,this.checked=b.value.findIndex(function(b){return b==a.value})>-1,b.register(this))},onClick:function(){this.checked=!this.checked,this.data&&(this.checked?this.data.add(this.value):this.data.remove(this.value)),this.trigger("change",this.checked)}}),a.registerComponent("checkbox-group",{template:'\n		<div class="checkbox-group">\n			<slot></slot>\n		</div>\n	',value:null,onCreated:function(){this.value=this.value||[],this.checkboxs=[]},register:function(a){this.checkboxs.push(a),a.on("change",this.onCheckboxChange.bind(this,a))},onCheckboxChange:function(a){a.checked?this.value.push(a.value):this.value.removeWhere(function(b){return b==a.value}),this.trigger("change",this.value)}}),a.registerComponent("switch",{template:'\n		<div class="switch" :class.active="value" @click="onClick">\n			<div class="switch-ball"></div>\n			<slot></slit>\n		</div>\n	',value:!1,onReady:function(){this.checkbox=this.el.find("[type=checkbox]"),this.checkbox.length&&(this.value=this.checkbox[0].checked)},onClick:function(){this.value=!this.value,this.checkbox.length&&(this.checkbox[0].checked=this.value),this.trigger("change",this.value)}}),a.registerComponent("form-fields",{template:"<form class=\"form-fields\" :autocomplete=\"autoComplete ? 'on' : 'off'\"><slot></slot></form>",messages:{required:apower.tr("This field is required@@field_required"),email:apower.tr("Please input a valid email address@@invalid_email"),phone:apower.tr("Please input a valid phone number@@invalid_phone"),minlength:function(a,b){return apower.tr("The minimum length should be {0}@@length_must_more",b.attr("minLength"))}},validators:{required:function(a,b){return!!a.trim()},email:function(a,b){return/^[\w-\+]+(?:\.[\w-\+]+)*@[\w-\+]+(?:\.[\w-\+]+)+$/.test(a.trim())},phone:function(a,b){return/^\d{7,14}$/.test(a.trim())},minlength:function(a,b){return a.trim().length>=b.attr("minLength")||0}},onlyValidateFirst:!1,autoComplete:!0,onCreated:function(){this.fields=[]},onReady:function(){this.el.find("button").on("click",function(a){return a.preventDefault()}),this.el.find("input[type=submit]").on("click",this.onSubmit,this),this.el.find("input").on("keydown",this.onKeydown,this)},register:function(a){this.fields.push(a)},getFieldValue:function(a){var b=this.getField(a);return b.getValue()},getField:function(a){return this.fields.find(function(b){return b.name===a})},setFieldValue:function(a,b){var c=this.fields.find(function(b){return b.name===a});c.setValue(b)},onKeydown:function(a){13===a.keyCode&&this.onSubmit(a)},onSubmit:function(a){a.preventDefault();var b=this.validate();b&&this.trigger("submit",this.getData())},validate:function(){var a=!0;this.onlyValidateFirst&&this.setUnTouched();var b=!0,c=!1,d=void 0;try{for(var e,f=this.fields[Symbol.iterator]();!(b=(e=f.next()).done);b=!0){var g=e.value,h=g.validate(),i=a&&!h;if(i&&g.focus(),a=a&&h,!a&&this.onlyValidateFirst)break}}catch(j){c=!0,d=j}finally{try{!b&&f["return"]&&f["return"]()}finally{if(c)throw d}}return a},validateFields:function(a){var b=!0,c=!0,d=!1,e=void 0;try{for(var f,g=this.fields[Symbol.iterator]();!(c=(f=g.next()).done);c=!0){var h=f.value;if(a.includes(h.name)&&(b=b&&h.validate(),!b&&this.onlyValidateFirst))break}}catch(i){d=!0,e=i}finally{try{!c&&g["return"]&&g["return"]()}finally{if(d)throw e}}return b},setUnTouched:function(){var a=!0,b=!1,c=void 0;try{for(var d,e=this.fields[Symbol.iterator]();!(a=(d=e.next()).done);a=!0){var f=d.value;f.setUnTouched()}}catch(g){b=!0,c=g}finally{try{!a&&e["return"]&&e["return"]()}finally{if(b)throw c}}},setError:function(a){var b=!0,c=!1,d=void 0;try{for(var e,f=this.fields[Symbol.iterator]();!(b=(e=f.next()).done);b=!0){var g=e.value;if(g.hasRule(a))return g.setError(a),!0}}catch(h){c=!0,d=h}finally{try{!b&&f["return"]&&f["return"]()}finally{if(c)throw d}}return console.warn('No field match rule "'+a+'"'),!1},getData:function(b){var c={},d=!0,e=!1,f=void 0;try{for(var g,h=this.fields[Symbol.iterator]();!(d=(g=h.next()).done);d=!0){var i=g.value;i.name&&(c[i.name]=i.getValue())}}catch(j){e=!0,f=j}finally{try{!d&&h["return"]&&h["return"]()}finally{if(e)throw f}}return b&&a.extend(c,b),c},getFormData:function(){var a=new FormData,b=!0,c=!1,d=void 0;try{for(var e,f=this.fields[Symbol.iterator]();!(b=(e=f.next()).done);b=!0){var g=e.value;g.name&&a.append(g.name,g.getValue())}}catch(h){c=!0,d=h}finally{try{!b&&f["return"]&&f["return"]()}finally{if(c)throw d}}if(overwrite){var i=!0,j=!1,k=void 0;try{for(var l,m=overwrite[Symbol.iterator]();!(i=(l=m.next()).done);i=!0){var n=l.value;a.append(n,overwrite[n])}}catch(h){j=!0,k=h}finally{try{!i&&m["return"]&&m["return"]()}finally{if(j)throw k}}}return a}}),a.registerComponent("field",{template:'\n		<div class="field" :class.field-border-through="borderThrough" :class.touched="touched" :class.invalid="errorText" :class.valid="!errorText">\n			<div class="field-input-wrap"><slot></slot></div>\n			<div class="field-error-text" f-html="errorText"></div>\n		</div>\n	',messages:{},validators:{},rules:["required"],form:null,touched:!1,errorText:"",validateWhen:"change",borderThrough:!1,onCreated:function(){var a=this.closest("form-fields");if(!a)throw new Error('"field" must be contained by a "form-fields"');a.register(this),this.form=a;var b=!0,c=!1,d=void 0;try{for(var e,f=this.rules[Symbol.iterator]();!(b=(e=f.next()).done);b=!0){var g=e.value,h=this.messages[g]||this.form.messages[g];h||console.warn('"message" for rule "'+g+'" is not defined')}}catch(i){c=!0,d=i}finally{try{!b&&f["return"]&&f["return"]()}finally{if(c)throw d}}},onReady:function(){var b=this;this.input=this.el.find("textarea, input"),this.input.on("input",this.onInput,this),this.name=this.input.attr("name"),["change","blur"].includes(this.validateWhen)&&this.input.on(this.validateWhen,this.validate,this),1===this.el.find(".drop-select").length&&this.el.find(".drop-select").com().on("change",function(){a.nextTick(function(){b.validate()})})},onInput:function(){"input"===this.validateWhen?this.validate():this.input.val().trim()&&(this.errorText=""),this.input.val().trim()?this.el.addClass("inputted"):this.el.removeClass("inputted")},getValue:function(){return"file"!==this.input[0].type?this.input.val():void this.input[0].files[0]},setValue:function(a){this.input.val(a)},validate:function(){var a=!0,b=!0,c=!1,d=void 0;try{for(var e,f=this.rules[Symbol.iterator]();!(b=(e=f.next()).done);b=!0){var g=e.value,h=this.messages[g]||this.form.messages[g];if(a=this.isRuleValid(g),!a){this.setErrorMessage(h);break}}}catch(i){c=!0,d=i}finally{try{!b&&f["return"]&&f["return"]()}finally{if(c)throw d}}return a&&(this.errorText=""),this.setTouched(),a},isRuleValid:function(a){var b=this.validators[a]||this.form.validators[a];return b?b.call(this,this.input.val(),this.input):!0},focus:function(){this.input.focus()},setTouched:function(){this.touched=!0},setUnTouched:function(){this.touched=!1,this.errorText=""},hasRule:function(a){return this.rules.findIndex(function(b){return b==a})>-1},setError:function(a){var b=this.messages[a]||this.form.messages[a];b?this.setErrorMessage(b):console.warn('"message" for rule "'+a+'" is not defined')},setErrorMessage:function(a){this.setTouched(),this.errorText="function"==typeof a?a.call(this,this.input.val(),this.input):a}}),a.registerComponent("drop",{template:'\n		<div class="drop">\n			<slot></slot>\n			<icon :type="icon"></icon>\n			<div class="drop-menu" :class="menuClass" ref="menu">\n				<div class="ap-trangle"></div>\n			</div>\n		</div>\n	',align:"b",gap:"0",menuClass:"",open:!1,event:"hover",icon:"down",onReady:function(){var a=this.el.find("ul");a.closest(this.menu).length||this.menu.append(a),this.isOld?(this.el.css("overflow","visible"),this.menu.css("position","fixed")):this.menu.appendTo(document.body),"hover"===this.event?this.el.on("mouseenter",this.onMouseEnter,this):this.el.on(this.event,this.onClick,this),"mousedown"===this.event&&this.menu.on("mousedown",this.preventMouseDown,this),this.menu.on("click",this.onClickMenu,this)},onMouseEnter:function(b){a(b.target).closest(this.menu).length||this.willShowMenu()&&(this.onBeforeMenuShow(),this.showMenu(),a.env.isTouch&&a("body").children().on("mousedown",this.onDocMouseDown,this),a.onceAllLeave([this.el,this.menu],200,this.hideMenu,this))},willShowMenu:function(){return!0},onBeforeMenuShow:function(){},showMenu:function(){this.menu.stop().fadeIn(200),this.alignMenu(),this.el.addClass("active"),this.open=!0,a.nextTick(this.onAfterMenuShow,this)},alignMenu:function(){this.menu.alignTo(this.el,this.align,this.gap,!0)},onAfterMenuShow:function(){},onClickMenu:function(){this.hideMenu()},hideMenu:function(){this.menu.stop().fadeOut(200),this.el.removeClass("active"),this.open=!1,a(document).off("mousedown",this.onDocMouseDown,this)},onClick:function(b){a(b.target).closest(this.menu).length||(this.open?this.hideMenu():(this.onBeforeMenuShow(),this.showMenu(),a(document).on("mousedown",this.onDocMouseDown,this)),b.preventDefault(),b.stopPropagation())},onDocMouseDown:function(b){a(b.target).closest(this.el).length||a(b.target).closest(this.menu).length||this.hideMenu()},preventMouseDown:function(a){a.preventDefault()},onDestroy:function(){this.menu.remove()}}),a.registerComponent("drop-select","drop",{template:'\n		<div class="drop drop-select">\n			<slot>{{getDisplay()}}</slot>\n			<icon :type="icon"></icon>\n			<div class="drop-menu drop-select-menu" :class="menuClass" ref="menu">\n				<ul>\n					<li f-for="item of getOptionData()" @click="selectValue(item[0])" :class.active="value == item[0]">{{item[1]}}</li>\n				</ul>\n			</div>\n		</div>\n	',event:"click",value:"",data:null,select:null,minMenuWidth:0,onReady:function(){this.initInnerSelect(),"mousedown"===this.triggerType&&this.ul.on("mousedown",function(a){return a.preventDefault()})},initInnerSelect:function(){var a=this.el.find("select");if(a.length){this.select=a,this.el.append(this.select),this.value=a.val();var b=this.data=[];a.find("option").map(function(a,c){b.push([c.value,c.textContent])}),this.on("change",function(b){var c=a.find("option").filter(function(a,c){return c.value==b});c.attr("selected",!0)},this)}},getDisplay:function(){var a=this.getOptionData(),b=!0,c=!1,d=void 0;try{for(var e,f=a[Symbol.iterator]();!(b=(e=f.next()).done);b=!0){var g=e.value,h=_slicedToArray(g,2),i=h[0],j=h[1];if(i===this.value)return j}}catch(k){c=!0,d=k}finally{try{!b&&f["return"]&&f["return"]()}finally{if(c)throw d}}return this.value},getOptionData:function(){var a=this.data,b=[];if(a)if(a.length)for(var c=0;c<a.length;c++){var d=a[c],e=d;Array.isArray(d)&&(e=d[1],d=d[0]),b.push([d,e])}else if("object"===("undefined"==typeof a?"undefined":_typeof(a)))for(var f in a){var g=a[f];b.push([f,g])}return b},selectValue:function(a){this.setValue(a),this.trigger("select",a)},setValue:function(a){this.hideMenu(),a!==this.value&&(this.value=a,this.setValueToInnerSelect(a),this.trigger("change",a))},setValueToInnerSelect:function(a){this.select&&(this.select.find("option").removeAttr("selected"),this.select.find("option[value="+a+"]").attr("selected","selected"))},onBeforeMenuShow:function(){this.setMenuWidth()},setMenuWidth:function(){var a=Math.max(this.minMenuWidth,this.el[0].offsetWidth);this.menu.css("min-width",a)}}),a.registerComponent("color-select","drop-select",{template:'\n		<div class="drop drop-select color-select">\n			<slot>{{value}}</slot>\n			<icon :type="icon"></icon>\n			<div class="drop-menu color-select-menu" :class="menuClass" ref="menu">\n				<div class="ap-trangle"></div>\n				<ul>\n					<li f-for="color of data" @click="selectValue(color)" :class.active="value == color" :style.background-color="color"></li>\n				</ul>\n			</div>\n		</div>\n	',value:"#000000",data:["#000000","#424242","#626262","#9d9d95","#c7c7c7","#efefef","#f7f7f7","#ffffff","#ff0000","#ff9d00","#ffff00","#00ff00","#00ffff","#0000ff","#9d00ff","#ff00ff","#f7c7cf","#ffebcb","#ffebcb","#d7efd7","#d3dbe7","#cfe7f7","#d3dbe7","#e7d7df","#e79d9d","#ffc79d","#ffe79d","#b5d7a5","#a5c7cf","#9dc7ef","#b5a5d7","#d7a5bd","#e76262","#f7ad6a","#ffd762","#95bd7a","#72a5ad","#6aaddf","#8d7ac7","#c77aa5","#cf0000","#e79538","#efc730","#6aa54a","#4a7a8d","#3885c7","#624aa5","#a54a7a","#9d0000","#b56208","#bd9500","#387a20","#104a5a","#085295","#301872","#721842","#620000","#7a3800","#285218","#285218","#083038","#003062","#20104a","#4a1030"]}),a.registerComponent("inputable-select","drop-select",{template:'\n		<div class="drop drop-select inputable-select">\n			<slot>{{value}}</slot>\n			<icon :type="icon"></icon>\n			<div class="drop-menu inputable-select-menu" :class="menuClass" ref="menu" hidden>\n				<div class="inputable-select-search" :class.active="suggest">\n					<input type="text" f-model="suggest" ref="input">\n					<icon type="search-thick"></icon>\n				</div>\n				<ul>\n					<li f-for="item of getOptionData()" @click="selectValue(item[0])" :class.active="value == item[0]">{{item[1]}}</li>\n				</ul>\n			</div>\n		</div>\n	',align:"bl",gap:"10 -40",
suggest:"",onReady:function(){var a=this;this.watch("suggest",function(){a.alignMenu()})},onAfterMenuShow:function(){this.input.focus()},getOptionData:function(){var a=this.data,b=this.suggest.toLowerCase(),c=[];if(a)if(a.length)for(var d=0;d<a.length;d++){var e=a[d],f=e;Array.isArray(e)&&(f=e[1],e=e[0]),(!b||f.toLowerCase().includes(b))&&c.push([e,f])}else if("object"===("undefined"==typeof a?"undefined":_typeof(a)))for(var g in a){var h=a[g];(!b||h.toLowerCase().includes(b))&&c.push([g,h])}return c}}),a.registerComponent("win",{template:'\n		<div class="win" f-loading="loading">\n			<div class="win-head" ref="head"></div>\n			<div class="win-body" ref="body"></div>\n			<div class="win-foot" ref="foot"></div>\n		</div>\n	',autoDestroy:!1,target:"body",mask:!0,hideByDefault:!0,onReady:function(){var b=this;this.hideByDefault&&this.el.hide(),this.body&&this.body.stopScroll(),this.on("show",this.onShow,this),this.on("hide",this.onHide,this),this.mask&&(this.maskEl=a('<div class="win-mask" ref="maskEl"></div>'),this.on("show",function(a){b.el.before(b.maskEl),b.maskEl.css("z-index",b.el.css("z-index")),b.maskEl.stop().fadeIn(a)}),this.on("hide",function(){b.maskEl.stop().fadeOut(200)}),this.on("destroy",function(){b.maskEl.remove()})),this.closeEl=this.createFromTemplate('<div class="win-close" ref="closeEl"><icon type="close-wide"></icon></div>').appendTo(this.el),this.closeEl.on("click",this.whenCloseWin,this)},onDestroy:function(){a(window).off("resize",this.alignWin,this),a("body").removeClass("body-fixed"),this.maskEl&&this.maskEl.remove()},show:function(){var b=arguments.length>0&&void 0!==arguments[0]?arguments[0]:200;this.el.show(),this.el.css("display","flex"),this.alignWin(),this.el.stop().fadeIn(b),this.trigger("show",b),a("body").addClass("body-fixed"),a(window).on("resize",this.alignWin,this)},alignWin:function(){this.el.alignTo(document.body,"c")},onShow:function(){},onHide:function(){},hide:function(){this.el.stop().fadeOut(200,this.onHidden.bind(this)),this.trigger("hide"),a("body").removeClass("body-fixed"),a(window).off("resize",this.alignWin,this)},whenCloseWin:function(){this.hide()},onHidden:function(){this.autoDestroy&&this.destroy()},showLoading:function(){this.loading=!0},hideLoading:function(){this.loading=!1}}),a.msg=a.newComponent("win",{template:'\n		<div class="win msg" :class="[\'msg-\' + type, class]" f-loading="loading">\n			<div class="win-body msg-body" ref="body">\n				<div class="msg-title" f-html="title" f-show="title"></div>\n				<div class="msg-text" f-html="message" f-show="message"></div>\n				<div class="msg-field" f-show="type === \'prompt\'">\n					<input class="msg-input" type="text" f-model="value" @keydown="onKeydown(\'ok\')" required :attr="inputAttributes" ref="input">\n				</div>\n			</div>\n			<div class="win-foot msg-foot" ref="foot">\n				<button f-for="btn, text in buttons"\n					f-disable="type === \'prompt\' && btn === \'ok\' && !value"\n					@click="handleButton(btn)"\n					:attr.type="btn === \'ok\' ? \'primary\' : \'\'"\n				>{{text}}</button>\n			</div>\n		</div>\n	',type:"",target:"",onReady:function(){this.closeEl.$on("click",this.onCancelMsg,this)},onCancelMsg:function(a){this.handleButton("cancel")},onKeydown:function(a){(10===a.keyCode||13===a.keyCode)&&this.handleButton("ok")},handleButton:function(a){this.hide(),this.fn&&this.fn.call(this.scope,a,this.value),this.resolve("prompt"===this.type?"ok"===a?this.value:"":a)},showMsg:function(b,c,d,e,f,g,h){var i=this;return this.el.parent().length||this.el.appendTo("body"),"string"==typeof c&&(g=f,f=e,e=d,d=c,c=null),"string"!=typeof e&&(g=f,f=e,e=d,d=""),"function"!=typeof f&&(h=f,f=null),h=h||{},this.type=b,this.buttons=c||h.buttons,this.title=d||h.title,this.message=e,this.fn=f||h.handler,this.scope=g,this.value=h.value||"",this["class"]=h["class"],this.inputAttributes=h.inputAttributes,this.buttons||(this.buttons=this.defaultButtons[b]),Array.isArray(this.buttons)&&(this.buttons=this.buttons.index(function(a){return[a,apower.tr(i.buttonTexts[a])]})),this.promise=new Promise(function(a){i.resolve=a}),a.digest(),a.nextTick(function(){i.show(),"prompt"===i.type&&i.input.focus()}),this.promise},buttonTexts:{ok:"OK@@001410",yes:"Yes@@yes",no:"No@@no",cancel:"Cancel@@cancel"},defaultButtons:{info:[],alert:["ok"],error:["ok"],success:["ok"],prompt:["ok"],confirm:["cancel","ok"]},info:function(){for(var a=arguments.length,b=Array(a),c=0;a>c;c++)b[c]=arguments[c];return this.showMsg.apply(this,["info"].concat(_toConsumableArray(b)))},alert:function(){for(var a=arguments.length,b=Array(a),c=0;a>c;c++)b[c]=arguments[c];return this.showMsg.apply(this,["alert"].concat(_toConsumableArray(b)))},error:function(){for(var a=arguments.length,b=Array(a),c=0;a>c;c++)b[c]=arguments[c];return this.showMsg.apply(this,["error"].concat(_toConsumableArray(b)))},success:function(){for(var a=arguments.length,b=Array(a),c=0;a>c;c++)b[c]=arguments[c];return this.showMsg.apply(this,["success"].concat(_toConsumableArray(b)))},prompt:function(){for(var a=arguments.length,b=Array(a),c=0;a>c;c++)b[c]=arguments[c];return this.showMsg.apply(this,["prompt"].concat(_toConsumableArray(b)))},confirm:function(){for(var a=arguments.length,b=Array(a),c=0;a>c;c++)b[c]=arguments[c];return this.showMsg.apply(this,["confirm"].concat(_toConsumableArray(b)))}}),a.notify=a.newComponent({template:'\n		<div class="notify">\n			<div class="notify-item"\n				f-for="item of stack"\n				f-transition="fade"\n				:class="\'notify-type-\' + item.type"\n			>\n				<div class="notify-content">\n					<div class="notify-icon" :class="\'notify-icon-\' + item.type"></div>\n					<div class="notify-text">{{item.message}}</div>\n				</div>\n			</div>\n		</div>\n	',hideDelay:3e3,target:"body",onCreated:function(){this.stack=[]},showNotify:function(b){var c=this;this.stack.push(b);var d=Math.max(0,a(".header")[0]?a(".header")[0].getBoundingClientRect().bottom:0);this.el.css("top",d),a.digest(),a.defer(function(){c.stack.remove(b),a.digest()},b.hideDelay||this.hideDelay)},alert:function(a){var b=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return b.type="alert",b.message=a,this.showNotify(b)},success:function(a){var b=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return b.type="success",b.message=a,this.showNotify(b)}}),a.registerComponent("wysiwyg",{template:'\n		<div class="wysiwyg">\n			<div class="wysiwyg-toolbar" ref="toolbar" @mousedown="onToolbarMouseDown">\n				<div class="wysiwyg-button" f-for="button of toolbars"\n					:class="\'wysiwyg-button-\' + button"\n					:class.active="activeToolbars.includes(button)" \n					@mousedown="onButtonMouseDown(button)"\n				></div>\n			</div>\n			<div class="wysiwyg-editor" contenteditable="true" ref="editor"\n				@mouseup="onEditorMouseUp"\n				@keydown="onKeyDown"\n				@input="onInput"\n				@blur="onBlur"\n				@paste="onPaste"\n				@dragenter="onDragEnter"\n				@dragleave="onDragLeave"\n				@dragover="onDragOver"\n				@drop="onDrop"\n			>\n			</div>\n			<slot></slot>\n		</div>\n	',TOOLBARS:{heading:"Heading@@heading",bold:"Bold@@bold",italic:"Italic@@italic",underline:"Underline@@underline",emoji:"Emoji@@add_an_emoji",link:"Insert Link@@insert_link",image:"Insert Image@@insert_image","align-left":"Align Left@@align_left","align-center":"Align Center@@align_center","align-right":"Align Right@@align_right","align-justify":"Align Justify@@align_justify",color:"Text Color@@text_color",background:"Background Color@@background_color",undo:"Undo@@undo",redo:"Redo@@redo"},STYLE_TOOLBARS:["bold","italic","underline","align-left","align-center","align-right","align-justify"],COMMANDS:{heading:"heading",bold:"bold",italic:"italic",underline:"underline",emoji:"emoji","align-left":"justifyLeft","align-center":"justifyCenter","align-right":"justifyRight","align-justify":"justifyFull",undo:"undo",redo:"redo"},emojis:["üôÇ","üòÄ","üôÅ","üòÆ","üòØ","üòï","üòé","üò°","üòõ","üòê","üòâ","üòÜ","üò≥","üò•","üëø","‚ùó","‚ùì","üí°"],toolbars:null,activeToolbars:null,name:"",textarea:null,saveAndRestore:!0,value:"",saved:!1,onCreated:function(){this.toolbars?"string"==typeof this.toolbars&&(this.toolbars=this.toolbars.split(" ")):this.toolbars=Object.keys(this.TOOLBARS),this.activeToolbars||(this.activeToolbars=["align-left"]),this.saveAndRestore&&a(window).on("unload",this.saveContentIfNotSaved,this)},saveContentIfNotSaved:function(){this.saved||this.saveContent()},saveContent:function(){this.saveContentToURL(location.href)},saveContentToURL:function(b){var c=this.getValue();c?(a.store.set("wysiwyg_content",c),a.store.set("wysiwyg_url",b)):(a.store.remove("wysiwyg_content"),a.store.remove("wysiwyg_url")),this.saved=!0},getValue:function(){return this.editor.html().replace(/<p>\s*<\/p>/g,"").trim()},setValue:function(a){this.editor.html(a),this.textarea.val(a)},clearValue:function(){this.setValue("<p></p>")},focus:function(){this.editor.focus()},onReady:function(){this.initHeading(),this.initEmojiSelect(),this.initColorSelect(),this.initBackgroundSelect(),this.initTextarea(),this.initToolbarTips(),document.execCommand("enableObjectResizing",!1,!1),document.execCommand("defaultParagraphSeparator",!1,"p"),this.value&&this.setValue(this.value)},initHeading:function(){this.headingSelect=this.newComponent("drop-select",{target:this.toolbar.find(".wysiwyg-button-heading"),event:"mousedown",menuClass:"wysiwyg-menu wysiwyg-heading-menu",icon:"",align:"bl",gap:"0",data:{h2:"h2",h3:"h3",h4:"h4",h5:"h5",h6:"h6",p:apower.tr("Paragrah@@paragrah")},value:"p"}),this.headingSelect.on("select",this.onSelectHeading,this)},onSelectHeading:function(a){this.exec("formatBlock",a)},initEmojiSelect:function(){this.emojiSelect=a.newComponent("drop-select",{target:this.toolbar.find(".wysiwyg-button-emoji"),event:"mousedown",menuClass:"wysiwyg-menu wysiwyg-emoji-menu",icon:"",align:"bl",gap:"0",data:this.emojis}),this.emojiSelect.on("select",this.onSelectEmoji,this)},onSelectEmoji:function(a){this.exec("insertText",a)},initColorSelect:function(){this.colorSelect=a.newComponent("color-select",{target:this.toolbar.find(".wysiwyg-button-color"),event:"mousedown",menuClass:"wysiwyg-menu",icon:"",align:"bl",gap:"0"}),this.colorSelect.on("select",this.onSelectColor,this)},onSelectColor:function(a){this.exec("foreColor",a)},initBackgroundSelect:function(){this.backgroundSelect=a.newComponent("color-select",{target:this.toolbar.find(".wysiwyg-button-background"),event:"mousedown",menuClass:"wysiwyg-menu",icon:"",align:"bl",gap:"0"}),this.backgroundSelect.on("select",this.onSelectBackground,this)},onSelectBackground:function(a){this.exec("backColor",a)},initTextarea:function(){if(!this.textarea){var a=this.el.find("textarea");this.textarea=a.length?a:this.createFromHTML('<textarea :name="name" ref="textarea"></textarea>').appendTo(this.el),this.textarea.hide()}this.setValue(this.textarea.val()||this.textarea.textContent)},initToolbarTips:function(){for(var a=this.toolbars.length-1;a>=0;a--){var b=this.toolbars[a];this.newDirective("tip",{el:this.toolbar.find(".wysiwyg-button-"+b),value:apower.tr(this.TOOLBARS[b])})}},save:function(){var a=getSelection();a.rangeCount>0&&(this.range=a.getRangeAt(0))},restore:function(){if(this.range){var a=getSelection(),b=a.rangeCount>0?a.getRangeAt(0):document.createRange();b.setStart(this.range.startContainer,this.range.startOffset),b.setEnd(this.range.endContainer,this.range.endOffset),this.range=null,0===a.rangeCount&&a.addRange(b)}else this.focus()},exec:function(b,c){if(document.activeElement!=this.editor[0]&&this.restore(),document.queryCommandSupported(b))document.execCommand(b,!1,c);else if("insertText"===b&&(b="insertHTML",c=a.encodeHTML(c)),"insertHTML"===b){var d=window.getSelection();if(d.rangeCount){var e=d.getRangeAt(0);e.deleteContents();var f=document.createElement("div");for(f.innerHTML=c;f.firstChild;)e.insertNode(f.firstChild);e.collapse(!1)}}},onToolbarMouseDown:function(a){a.preventDefault()},onButtonMouseDown:function(a){if(this.STYLE_TOOLBARS.includes(a)){this.activeToolbars.includes(a)?this.setButtonState(a,!1):this.setButtonState(a,!0);var b=this.COMMANDS[a];this.exec(b,null)}else if(["redo","undo"].includes(a)){var c=this.COMMANDS[a];this.exec(c,null)}else"link"===a?this.addOrRemoveLink():"image"===a&&this.addImage();this.save()},setButtonState:function(a,b){var c=this.toolbar.find(".wysiwyg-button-"+a);if(a.startsWith("align-")){for(var d=this.activeToolbars.length-1;d>=0;d--){var e=this.activeToolbars[d];e.startsWith("align-")&&(this.activeToolbars.splice(d,1),this.toolbar.find(".wysiwyg-button-"+e).removeClass("active"))}this.activeToolbars.push(a),b=!0}else this.activeToolbars.includes(a)&&!b?this.activeToolbars.remove(a):!this.activeToolbars.includes(a)&&b&&this.activeToolbars.push(a);b?c.addClass("active"):c.removeClass("active")},addOrRemoveLink:function(){var b=getSelection(),c=b.focusNode;c&&a(c).closest("a").length?this.exec("unlink"):this.addLink()},addLink:function(){var b=this,c=getSelection().toString(),d=a.newComponent("win",{template:'\n				<div class="win wysiwyg-win wysiwyg-link-win">\n					<div class="win-head" ref="head">Insert link@@insert_link</div>\n					<div class="win-body" ref="body">\n						<div class="wysiwyg-field">\n							<label class="wysiwyg-label">{{\'URL@@url\' | trans}}:</label>\n							<input type="text" class="wysiwyg-input" f-model="url" ref="urlInput" f-focus>\n						</div>\n						<div class="wysiwyg-field">\n							<label class="wysiwyg-label">{{\'Text@@text\' | trans}}:</label>\n							<input type="text" class="wysiwyg-input" f-model="text" ref="textInput" value="{text}">\n						</div>\n					</div>\n					<div class="win-foot" ref="foot">\n						<button @click="hide">Cancel@@cancel</button>\n						<button type="primary" @click="onOK">OK@@001410</button>\n					</div>\n				</div>\n			',autoDestroy:!0,text:c,url:"",onOK:function(){var a=this.url.trim();if(a){var c=this.textInput.val().trim()||a;this.hide(),b.doAddingLink(a,c)}else{var d=this.newDirective("tip",{el:this.urlInput,tipClass:"wysiwyg-error",value:apower.tr("This field is required@@field_required")});d.showTip(),this.urlInput.once("input",function(){d.unbind()})}}});d.show(),d.on("hide",this.restore,this)},doAddingLink:function(b,c){this.exec("insertHTML",'<a href="'+a.encodeHTML(b)+'">'+a.encodeHTML(c)+"</a>");var d=getSelection();if(d.focusNode&&d.focusNode){var e=a(d.focusNode.parentNode),f=e.closest("a");f.length&&d.extend(f[0])}},addImage:function(){a.selectFile("image/*",!1,this.onSelectImage,this)},onSelectImage:function(a){apower.uploadFile(a,this.onImageUploaded,this)},onImageUploaded:function(a){a&&this.exec("insertImage",a.url)},onEditorMouseUp:function(a){this.checkCurrentStyle()},checkCurrentStyle:function(){var b=getSelection();if(b.anchorNode&&b.focusNode){var c=a(b.anchorNode.parentNode),d=a(b.focusNode.parentNode);this.setButtonState("bold",c.css("font-weight")>400&&d.css("font-weight")>400),this.setButtonState("italic","italic"===c.css("font-style")&&"italic"===d.css("font-style")),this.setButtonState("underline",c.css("text-decoration").includes("underline")&&d.css("text-decoration").includes("underline"));var e=d.css("text-align");"start"===e?e="left":"end"===e&&(e="right"),this.setButtonState("align-"+e,!0),d.is("h2, h3, h4, h5, h6")?this.headingSelect.setValue(d[0].localName):this.headingSelect.setValue("p")}},onKeyDown:function(a){[33,34,35,36,37,38,39,40,46].includes(a.keyCode)&&this.checkCurrentStyle()},onInput:function(){this.saved=!1,this.trigger("input")},onBlur:function(){this.semantic();var a=this.getValue();this.textarea.val(a),this.value=a,this.trigger("change",a)},semantic:function(){for(var a=this.editor[0],b=Array.from(a.childNodes),c=[],d=function(){for(;c.length>0;){var b=c[0];if(3!==b.nodeType||b.textContent.trim())break;c.shift()}for(;c.length>0;){var d=c[c.length-1];if(3!==d.nodeType||d.textContent.trim())break;c.pop()}if(c.length>0){var e=document.createElement("p");a.insertBefore(e,c[0]);for(var f=0;f<c.length;f++)e.appendChild(c[f])}c=[]},e=0;e<b.length;e++){var f=b[e],g=!1;if(3===f.nodeType)c.push(f);else if(1===f.nodeType&&(getComputedStyle(f).display.includes("inline")?c.push(f):g=!0,"div"===f.localName&&f.textContent.trim())){var h=document.createElement("p");a.insertBefore(h,f);for(var i=Array.from(f.childNodes),j=0;j<i.length;j++)h.appendChild(i[j]);f.remove()}g&&d()}d()},onPaste:function(a){a.clipboardData.files&&a.clipboardData.files[0]&&a.clipboardData.files[0].type.startsWith("image/")&&(a.preventDefault(),this.onSelectImage(a.clipboardData.files[0]))},onDragEnter:function(a){a.preventDefault(),this.editor.addClass("dragging")},onDragLeave:function(a){a.preventDefault(),this.editor.removeClass("dragging")},onDragOver:function(a){a.preventDefault()},onDrop:function(a){a.preventDefault(),this.editor.removeClass("dragging"),a.dataTransfer.files&&a.dataTransfer.files[0]&&a.dataTransfer.files[0].type.startsWith("image/")&&this.onSelectImage(a.dataTransfer.files[0])}}),a.registerComponent("route",{template:'\n		<div class="route" :class="routeClass" @click="onClick" f-loading="loading"></div>\n	',map:null,redirects:null,defaultURL:"",prefix:"",ignoreURLs:null,routeClass:"",path:"",rule:null,loading:!0,query:null,onCreated:function(b){this.map=this.map||{},this.oldCSSEls=null,this.cssEls=a(),this.loadedJs={},this.loadedPage={},this.query=a.parseQuery(location.search),this.initMap(),this.initURLChange()},onDestroy:function(){a(window).off("popstate",this.onStateChange,this)},onClick:function(b){var c=a(b.target).closest("a");if(c.length&&"_blank"!==c.attr("target")){var d=c[0].href;if(d&&!d.startsWith("javascript:")&&!d.endsWith("#")){var e=this["goto"](d);e&&b.preventDefault()}}},initMap:function(){for(var a in this.map)this.map[a]=this.initMapItem(a,this.map[a]);if(this.redirects)for(var a in this.redirects)this.redirects[a]=this.initRedirectItem(a,this.redirects[a])},setMap:function(a,b){this.map[a]=this.initMapItem(a,b)},initMapItem:function(a,b){"string"==typeof b&&(b={template:b}),b.css="string"==typeof b.css?[b.css]:b.css||[],b.js="string"==typeof b.js?[b.js]:b.js||[];var c=this.getURLRE(a),d=_slicedToArray(c,2);return b.re=d[0],b.keys=d[1],b},initRedirectItem:function(a,b){"object"!==("undefined"==typeof b?"undefined":_typeof(b))&&(b={url:b});var c=this.getURLRE(a),d=_slicedToArray(c,1);return b.re=d[0],b},getURLRE:function(a){var b=[],c=new RegExp(a.replace(/(\/?):(\w+)/g,function(a,c,d){return d&&b.push(d),c+"?([\\w-]*?)"}).replace(/\/$/g,"/?").replace(/\//g,"\\/").replace(/\./g,"\\.").replace(/^/,"^").replace(/$/,"$"),"i");return[c,b]},initURLChange:function(){a(window).on("popstate",this.onStateChange,this)},onStateChange:function(a){a.state&&this.redirectTo(a.state.url)},"goto":function(a){return this._load(a,"goto")},redirectTo:function(a){return this._load(a,"redirect")},load:function(a){return this._load(a,"load")},loadCurrentURL:function(){return this.redirectTo(location.href)},_load:function(a,b){var c=this.getRelativePathFromURL(a),d=this.findMatchedRoute(c);if(d)return this.onRouteMatched(c,a,d,b),!0;var e=this.getRedirectPath(c);return e&&e!==c?this.redirectTo(a):(this.defaultURL&&this.defaultURL!==c&&!this.willIgnore(c)&&this.redirectTo(this.defaultURL),!1)},gotoDefault:function(){this["goto"](this.defaultURL)},getRelativePathFromURL:function(a){var b=location.protocol+"//"+location.hostname,c=a.replace(/[\?#].+/,"");return c.startsWith(b)&&(c=c.replace(b,"")),this.prefix&&c.startsWith(this.prefix)&&(c=c.slice(this.prefix.length)),c||"/"},findMatchedRoute:function(a){for(var b in this.map){var c=this.map[b];if(c.re.test(a))return c}return null},getRedirectPath:function(a){if(this.redirects)for(var b in this.redirects){var c=this.redirects[b];if(c.re.test(a))return c.url}},willIgnore:function(a){if(this.ignoreURLs)for(var b=0;b<this.ignoreURLs.length;b++){var c=this.ignoreURLs[b];if(c===a||c.test&&c.test(a))return!0}return!1},onRouteMatched:function(b,c,d,e){for(var f=this,g=a.parseQuery(c),h=b.matches(d.re,1),i=0;i<d.keys.length;i++){var j=d.keys[i];g[j]=h[i]}this.oldCSSEls=this.cssEls,this.cssEls=a();var k=0,l=0,m=function(){++k===l&&f.onSourceLoaded(d,b,g)},n=!0,o=!1,p=void 0;try{for(var q,r=d.css[Symbol.iterator]();!(n=(q=r.next()).done);n=!0){var s=q.value,t=a('<link rel="stylesheet" href="{0}">'.format(s));l++,this.cssEls=this.cssEls.add(t),t.appendTo("head").on("load",m)}}catch(u){o=!0,p=u}finally{try{!n&&r["return"]&&r["return"]()}finally{if(o)throw p}}var v=function(b){if(!f.loadedJs[b]){l++;var c=document.createElement("script");c.async=!1,c.src=b,document.head.appendChild(c),a(c).on("load",function(){f.loadedJs[b]=!0,m()})}},w=!0,x=!1,y=void 0;try{for(var z,A=d.js[Symbol.iterator]();!(w=(z=A.next()).done);w=!0){var B=z.value;v(B)}}catch(u){x=!0,y=u}finally{try{!w&&A["return"]&&A["return"]()}finally{if(x)throw y}}d.template&&(d.template=d.template.replace(/<template src="(.+?)"><\/template>/g,function(b,c){return l++,a.get(this.getPrefixedURL(c),function(a){d.template=d.template.replace('<template src="'+c+'"></template>',a),m()}.bind(this)),b}.bind(this))),"redirect"===e?this.replaceURL(c):"goto"===e&&this.pushURL(c),d.title&&(document.title=d.title),0===l?this.onSourceLoaded(d,b,g):this.loadedPage[b]||(this.loading=!0,this.loadedPage[b]=!0)},onSourceLoaded:function(b,c,d){this.loading=!1;var e=this.rule;if(e&&e.com)if(e.cache){var f=!0,g=!1,h=void 0;try{for(var i,j=e.com.el[Symbol.iterator]();!(f=(i=j.next()).done);f=!0){var k=i.value;k.parentNode&&k.parentNode.removeChild(k)}}catch(l){g=!0,h=l}finally{try{!f&&j["return"]&&j["return"]()}finally{if(g)throw h}}}else e.com.destroy(),e.com=null;if(this.rule=b,this.path=c,this.query=d,this.oldCSSEls.remove(),document.body.scrollTop=0,b.com)this.el.append(b.com.el);else{var m=this.prefix,n={prefix:m,target:this.el,query:this.query,route:this};b.template&&(n.template=b.template),b.com=this.newComponent(b.component||"",n)}this.trigger("goto",b),a.digest()},getPrefixedURL:function(a){if(this.prefix){var b=location.protocol+"//"+location.hostname;a.startsWith(b)?(a=a.slice(b.length),a.startsWith(this.prefix)||(a=this.prefix+a),a=b+a):a.startsWith(this.prefix)||(a=this.prefix+a)}return a},replaceURL:function(a){a=this.getPrefixedURL(a),history.replaceState({url:a},null,a)},pushURL:function(a){a=this.getPrefixedURL(a),history.pushState({url:a},null,a)},clearCache:function(a){var b=this.map[a];b&&b.com&&(b.com.destroy(),b.com=null)},clearAllCache:function(){var a=!0,b=!1,c=void 0;try{for(var d,e=Object.values(this.map)[Symbol.iterator]();!(a=(d=e.next()).done);a=!0){var f=d.value;f.com&&(f.com.destroy(),f.com=null)}}catch(g){b=!0,c=g}finally{try{!a&&e["return"]&&e["return"]()}finally{if(b)throw c}}},formatHTML:function(a){var b=this;return this.prefix&&(a=a.replace(/href="(.+?)"/g,function(a,c){var d=b.getRelativePathFromURL(c),e=b.findMatchedRoute(d);return e?'href="'+b.getPrefixedURL(c)+'"':a})),a}}),a.registerDirective("goto",{isLiteral:!0,value:"",route:null,bind:function(){this.route=this.vm.closest("route"),this.el.on("click",this.onClick,this)},update:function(a){this.value=a},onClick:function(a){this.route["goto"](this.value)}}),a.registerComponent("search-form","drop",{template:'\n		<div class="search-form">\n			<icon type="search-thick"></icon>\n			<form class="drop-menu search-form-menu" target="_blank" action="https://www.google.com/search" :class="menuClass" ref="menu">\n				<div class="ap-trangle"></div>\n				<input type="hidden" name="as_sitesearch" :value="getDomain()">\n				<input type="text" :placeholder="\'Search {0}@@search_site\' | trans(getDomain())" name="as_q" ref="input">\n				<input type="submit">\n				<icon type="search-thick"></icon>\n			</form>\n		</div>\n	',onAfterMenuShow:function(){this.input.focus()},onClickMenu:function(){},getDomain:function(){return apower.getDomain()}}),a.registerComponent("language-win","win",{template:'\n		<nav class="win language-win">\n			<ul class="win-body">\n				<li f-for="item of data" :class="item[0]"><a :href="getURL(item[1])">{{item[3]}}</a></li>\n			</ul>\n		</nav>\n	',data:[["us","en","USA","English"],["fr","fr","France","Fran√ßais"],["de","de","Deutschland","Deutsch"],["it","it","Italia","Italiano"],["se","sv","Sverige","Svenska"],["nl","nl","Nederland","Nederlands"],["es","es","Espa√±a","Espa√±ol"],["br","pt","Brasil","Portugu√™s"],["fi","fi","Suomi","Suomi"],["no","no","Norge","Norsk"],["dk","da","Danmark","Dansk"],["tr","tr","T√ºrkiye","T√ºrk√ße"],["pl","pl","Polska","Polski"],["jp","ja","Êó•Êú¨","Êó•Êú¨Ë™û"],["tw","tw","‰∏≠ÂúãÂè∞ÁÅ£","ÁπÅÈ´î‰∏≠Êñá"],["cn","zh","‰∏≠ÂõΩ","ÁÆÄ‰Ωì‰∏≠Êñá"],["hu","hu","Magyarorsz√°gon","Magyar"],["cz","cs","ƒåe≈°tina","ƒåe≈°tina"],["gr","el","ŒïŒªŒªŒ¨Œ¥Œ±","ŒµŒªŒªŒ∑ŒΩŒπŒ∫Œ¨"],["pt","pt","Portugal","Portugu√™s"]],autoDestroy:!0,target:"body",onCreated:function(){this.apower=apower},getURL:function(a){return apower.getDomain(a)}}),a.registerComponent("language-select",{template:'\n		<div class="language-select" @click="openWin">\n			<div class="language-select-flag"></div>\n			<div class="language-select-name"></div>\n			<icon type="up"></icon>\n		</div>\n	',openWin:function(){a.newComponent("language-win").show()}}),a.registerComponent("paging",{pages:0,currentPage:1,template:'\n		<div class="paging" f-show="pages > 1">\n			<ul>\n				<li class="paging-prev" f-enable="currentPage > 1" @click="selectPage(currentPage - 1)">Prev@@prev</li>\n				<li f-for="index of getSelectablePages()" @click="selectPage(index)" :class.active="index === currentPage">{{index}}</li>\n				<li class="paging-next" f-enable="currentPage < pages" @click="selectPage(currentPage + 1)">Next@@next</li>\n			</ul>\n		</div>\n	',getSelectablePages:function(){var a=this.pages,b=this.currentPage,c=b-2,d=b+2;1>c&&(c=1,d=5),d>a&&(d=a,c=Math.max(1,a-4));for(var e=[],f=c;d>=f;f++)e.push(f);return e},selectPage:function(a){this.currentPage=a,this.trigger("select",a)}}),a.getDirective("tip").prototype.selector="[data-tip]",a.getDirective("tip").prototype.setTip=a.getDirective("tip").prototype.setValue,a.getDirective("tip").prototype.init=function(){this.value=this.value||this.el.attr("data-tip")||this.tip},a.getComponent("drop").prototype.selector=".drop, [data-drop]",a.getComponent("drop").prototype.init=function(){this.isOld&&(a.newComponent("icon",{type:"down",target:this.el}),this.label=this.el.find("label"),this.menu=a('<div class="drop-menu '+this.menuClass+'"></div>').appendTo(this.el),this.menu.prepend('<div class="ap-trangle"></div>'))},a.getComponent("drop-select").prototype.selector=".drop-select",a.getComponent("drop-select").prototype.init=a.getComponent("drop").prototype.init,a.getComponent("win").prototype.selector=".win",a.getComponent("win").prototype.ref={head:".win-head",body:".win-body",foot:".win-foot"},a.getComponent("win").prototype.init=function(){if(this.el.parent().is(".win-mask")){var a=this.el.parent();a.after(this.el),a.remove()}},a.registerDir("layer",{align:"t",gap:"0",open:!1,triggerType:"hover",layer:null,hasTransformAndTransition:!1,selector:"[data-layer]",trangle:!0,time:"",init:function(){var b=this.layer||this.el.attr("data-layer");if("string"==typeof b){var c=(b.startsWith(".")?"":".")+b,d=(this.el[0],this.el.find(c)[0]||this.el.findNearestBehind(c)[0]);this.layer=a(d)}this.hasTransformAndTransition=this.layer.css("transition").includes("transform")||"0"==this.layer.css("transform").select(/\d+/),!this.layer.find(".ap-trangle").length&&this.trangle&&this.layer.prepend('<div class="ap-trangle"></div>'),"hover"===this.triggerType?this.el.on("mouseenter",this.onMouseEnter,this):this.el.on(this.triggerType,this.onClick,this)},unbind:function(){this.el.off("mouseenter",this.onMouseEnter,this)},onMouseEnter:function(){this.showLayer()},onClick:function(){this.open?this.hideLayer():this.showLayer()},showLayer:function(){this.open||(this.hasTransformAndTransition&&(this.layer.css("transform","none"),this.layer.css("transition","none")),this.time=this.el.attr("data-time")||300,this.time?this.layer.fadeIn(parseInt(this.time)):this.layer.fadeIn(),this.layer.alignTo(this.el,this.align,this.gap),this.hasTransformAndTransition?(this.layer.css("transform",""),this.layer[0].offsetWidth,this.layer.css("transition",""),this.layer.css("transform","none")):(this.layer.hide(),this.layer.fadeIn(300)),this.el.addClass("active"),this.open=!0,a.onceAllLeave(this.el[0].contains(this.layer[0])?[this.el]:[this.el,this.layer],200,this.hideLayer,this))},hideLayer:function(){this.hasTransformAndTransition?this.layer.css("transform",""):this.layer.fadeOut(300),this.el.removeClass("active"),this.open=!1}}),apower.sharer=a.registerOnce({callbacks:{},data:{},getShareCount:function(b,c,d){if(b=b||location.href.replace(/\?.+/,""),this.data[b])c.call(d,this.data[b]);else if(this.callbacks[b])this.callbacks[b].push({handler:c,scope:d});else{this.callbacks[b]=[{handler:c,scope:d}];var e=apower.isOurDomain?"":apower.getDomain();a.ajax({type:"POST",url:e+"/wp-admin/admin-ajax.php?action=social_bookmark&type=get_data",data:JSON.stringify({url:b}),dataType:"json",success:function(a){if(a.services){var c=a.services;delete c.twitter,c.hatena=c["b.hatena.ne.jp"]||c.hatena,delete c["b.hatena.ne.jp"];for(var d in c){var e=Number(c[d])||0;e>=1e3&&(e=Math.ceil(e/100)/10+"K"),c[d]=e}this.data[b]=c;for(var d=0;d<this.callbacks[b].length;d++){var f=this.callbacks[b][d].handler,g=this.callbacks[b][d].scope;f.call(g,c)}}delete this.callbacks[b]}.bind(this)})}}}),a.registerDir("bind-share",{selector:"[data-share], .apower-counted-share",props:["share","share-url","share-title","align","gap","use-apower-qrcode"],share:"",shareUrl:"",shareTitle:"",align:"r",gap:10,init:function(){var b=new RegExp(Object.keys(this.links).join("|"));this.el.$on("click",function(c){var d=this.share;if(!d){var e=a(c.target).closest("li")[0];e&&(d=e.className.select(b,0))}d&&this.shareTo(d,this.shareUrl,this.shareTitle,"",e)},this),this.el.find("li").$on("mouseenter",function(c){var d=a(c.target).closest("li")[0];d&&(name=d.className.select(b,0)),name&&this.links[name].img&&this.shareTo(name,this.shareUrl,this.shareTitle,"",d)},this)},links:{google:{url:"https://plus.google.com/share?url={url}&t={title}",width:500,height:500},facebook:{url:"http://www.facebook.com/sharer/sharer.php?u={url}&title={title}",width:673,height:374},twitter:{url:"https://twitter.com/intent/tweet?url={url}&text={title}",width:548,height:430},pinterest:{url:"//assets.pinterest.com/js/pinmarklet.js",append:!0,width:600,height:400},hatena:{url:"http://b.hatena.ne.jp/entry/panel/?url={url}&btitle={title}",width:365,height:220},linkedin:{url:"https://www.linkedin.com/shareArticle?mini=true&url={url}&title={title}",width:600,height:600},weixin:{img:"/do.php?action=qrcode&data={url}&size=5"},douban:{url:"http://www.douban.com/share/service?href={url}&name={title}&text={text}"},qzone:{url:"http://sns.qzone.qq.com/cgi-bin/qzshare/cgi_qzshare_onekey?url={url}&title={title}&desc={text}&summary=&site="},weibo:{url:"http://service.weibo.com/share/share.php?url={url}&title={title}&searchPic=true"},tencent:{url:"http://share.v.t.qq.com/index.php?c=share&a=index&url={url}&title={title}"},youdao:{url:"http://note.youdao.com/memory/?url={url}&title={title}"}},getShareLink:function(a,b,c,d){var e=this.links[a].url||this.links[a].img;"weixin"===a&&(e=apower.getDomain("zh")+e);var f={url:encodeURIComponent(b),title:encodeURIComponent(c),text:encodeURIComponent(d)};return e=e.format(f)},onopenparams:null,shareTo:function(b,c,d,e,f){var g=a(f);if(c=c||location.href,d=d||g.data("share-title")||document.title,e=e||g.data("share-text")||"","function"==typeof this.links[b])this.links[b](c,d,e,g);else{var h=this.getShareLink(b,c,d,e);if(this.links[b].append)a("body").append('<script src="'+h+'"></script>');else if(this.links[b].url){var i=this.links[b].width,j=this.links[b].height,k="";i&&j&&(k="width="+i+",height="+j),this.onopenparams&&(k=this.onopenparams(k,b)),window.open(h,"share-to-"+b,k)}else if(!g.dir("layer")){var l=a.newCom("layer",g,{align:this.align,gap:this.gap,layer:a('<div class="ap-qrcode"><img src="'+h+'"></div>').appendTo("body")});l.showLayer()}}}}),a.register("counted-share",{
selector:".apower-counted-share",ref:{items:"li",shareSpans:".apower-share-label",countSpans:".apower-share-count",twitterSpan:".apower-share-twitter .apower-share-label"},props:["share-url","share-title"],shareURL:"",shareTitle:"",countWidth:46,darkBg:!1,canClose:!1,template:function(){var a='<li class="apower-share-pinterest"><i></i><span class="apower-share-label">Pin</span><span class="apower-share-count">-</span></li>';"ja"===apower.lang&&(a='<li class="apower-share-hatena"><i></i><span class="apower-share-label">{@@share}</span><span class="apower-share-count">-</span></li>');var b=this.canClose?'<div class="apower-share-exit"></div>':"";return'<ul class="apower-counted-share" data-share-url="'+this.shareURL+'" data-share-title="'+this.shareTitle+'"><li class="apower-share-google"><i></i><span class="apower-share-label">+1</span><span class="apower-share-count">-</span></li><li class="apower-share-facebook"><i></i><span class="apower-share-label">{@@share}</span><span class="apower-share-count">-</span></li><li class="apower-share-twitter"><i></i><span class="apower-share-label">{@@share}</span><span class="apower-share-count">-</span></li>'+a+'<li class="apower-share-linkedin"><i></i><span class="apower-share-label">{@@share}</span><span class="apower-share-count">-</span></li>'+b+"</ul>"},init:function(){this.darkBg&&this.el.addClass("apower-share-darkbg");var b=this.spanWidths=[];this.shareSpans.each(function(c,d){b[c]=a(d).getTextWidth()+10}),this.items.$on("mouseenter",this.onEnterItem,this),this.el.$on("mouseleave",this.onLeaveEl,this),this.el.find(".apower-share-exit").$on("click",function(){this.destroy(!0)},this),apower.sharer.getShareCount(this.shareUrl,function(a){for(var b in a){var c=a[b];this.el.find(".apower-share-"+b).find(".apower-share-count").text(c)}},this)},onEnterItem:function(b){var c=a(b.target).closest("li"),d=this.items.indexOf(c),e=this.shareSpans.eq(d),f=this.countSpans.eq(d),g=this.spanWidths[d],h=c.is(".apower-share-twitter"),i=this.countWidth,j=h?Math.max(0,g-i):g;if(j){var k=i-j/(h?this.items.length-1:this.items.length-2);e.width(g),f.width(i),this.shareSpans.not(e).not(this.twitterSpan).width(0),this.countSpans.not(f).width(k),h||this.twitterSpan.width(i)}},onLeaveEl:function(){var a=this.countWidth;this.shareSpans.width(0),this.countSpans.width(a),this.twitterSpan.width(a)}}),a.registerDir("fit",{selector:"[data-fit], .article iframe",props:["fit","fit-direction"],fit:"",fitDirection:"both",ow:0,oh:0,init:function(){a(window).$on("resize",a.lazyThrottle(this.doFit.bind(this,!1),500),this),"pc"===this.fit?a.onToggleMobile(this.cancelFit,this.reFit,this):"mobile"===this.fit&&a.onToggleMobile(this.reFit,this.cancelFit,this);for(var b=this.el.parent();b[0]&&b[0]!==document.documentElement;)b=b.parent();a.defer(this.doFit.bind(this,!0))},doFit:function(b){var c=this.el;if(c[0]===(document.fullscreenElement||document.webkitFullscreenElement||document.mozFullscreenElement||document.msFullscreenElement))return void c.css("transform","none");this.ow||(this.ow=c[0].offsetWidth),this.oh||(this.oh=c[0].offsetHeight);var d=this.ow,e=this.oh;if(!(!d||!e||"pc"===this.fit&&window.innerWidth<=768||"mobile"===this.fit&&window.innerWidth>768)){var f=c.parent(),g=f.innerWidth(),h=f.innerHeight();if(g&&h){var i=c.cssNum("margin-left"),j=c.cssNum("margin-right"),k=parseFloat(c[0].style.marginTop),l=parseFloat(c[0].style.marginBottom);if(0>k&&l===k&&(h-=k+l),0!==i||0!==j){var m=c[0].style.display;"none"!==m&&(c[0].style.display="none",0!==i&&"auto"!==c.css("margin-left")&&(d+=i),0!==j&&"auto"!==c.css("margin-right")&&(d+=j),c[0].style.display=m)}var n=1,o="h"===this.fitDirection||"both"===this.fitDirection,p="v"===this.fitDirection||"both"===this.fitDirection;if(o&&d>g||p&&e>h){var q=h/e>=g/d;n=o&&q||!p?g/d:h/e}var r="scale("+n+")",s=c.css("transform-origin")||"",t=(s.split(" ")[1]||"").replace(/px/,"");t=Number(t)||0;var u=function(){if(1===n)c.css("margin-bottom",""),c.css("margin-top",""),c.css("transform","");else{var a=t*(n-1),b=(e-t)*(n-1);c.css("margin-bottom",b),c.css("margin-top",a),c.css("transform",r)}this.trigger("fit",c)}.bind(this);b?u():a.defer(u)}}},reFit:function(){this.ow=this.el[0].offsetWidth,this.oh=this.el[0].offsetHeight,this.doFit()},cancelFit:function(){this.el.css("margin-bottom",0).css("transform","none")},onDestroy:function(){a(window).$off("resize",this.doFit,this)}}),a.registerDir("tab",{selector:"[data-tab]",props:["tab"],tab:"",tabEl:null,init:function(){if(this.tab){var b=a("."+this.tab);b.length||(b=a("#"+this.tab)),b&&(this.tabEl=b,this.el.$on("click",this.onClick,this)),this.el.is(".active")&&!b.is(".active")&&a.defer(function(){this.el.click()},this)}},onClick:function(){var a=this.el,b=this.tabEl,c=b.siblings(".active");b[0]!==c[0]&&(a.siblings().removeClass("active"),a.addClass("active"),c.removeClass("active"),b.addClass("active"),c.length>0&&void 0===this.hasTransition&&(this.hasTransition=Number(String(c.css("transition-duration")).slice(0,-1))>0),this.hasTransition&&(b.show(),c.$once("transitionend",this.hideLastTab,this),this.lastTabEl=c),c.$trigger("tabinactive",c),b.$trigger("tabactive",b))},hideLastTab:function(){this.lastTabEl&&!this.lastTabEl.is(".active")&&(this.lastTabEl.hide(),this.lastTabEl=null)}}),a.registerDir("tab-wrap",{selector:"[data-tab-wrap]",props:["tab-wrap"],tabWrap:"",btnEls:"",tabEls:null,init:function(){if(this.tabWrap){this.btnEls=this.el.children(),this.btnEls.$on("click",this.onClick,this);var b=a("."+this.tabWrap);b.length||(b=a("#"+this.tabWrap)),b&&(this.tabEls=b.children());var c=this.btnEls.filter(".active").index();c>=0&&!this.tabEls.eq(c).is(".active")&&a.defer(function(){this.btnEls.eq(c).click()},this)}},onClick:function(b){var c=a(b.currentTarget),d=this.tabEls.eq(this.btnEls.indexOf(c)),e=d.siblings(".active");d[0]===e[0]||d.is(".active")||(this.btnEls.removeClass("active"),c.addClass("active"),e.removeClass("active"),d.addClass("active"),e.length>0&&void 0===this.hasTransition&&(this.hasTransition=Number(e.css("transition-duration").slice(0,-1))>0),this.hasTransition&&(d.show(),e.$once("transitionend",this.hideLastTab,this),this.lastTabEl=e),e.$trigger("tabinactive",e),d.$trigger("tabactive",d))},hideLastTab:function(){this.lastTabEl&&!this.lastTabEl.is(".active")&&(this.lastTabEl.hide(),this.lastTabEl=null)}}),a.register("switcher",{selector:".switcher",ref:{btnWrap:".switcher-btn",tabWrap:".switcher-tab",btns:".switcher-btn > li",tabs:".switcher-tab > li"},props:["mobile-collapse","interval","apply-class-to","toggle-active-to","mouseenter-collapse","no-height"],index:-1,interval:0,applyClassTo:"",applyClassToEl:null,toggleActiveTo:"",mobileCollapse:!1,mouseenterCollapse:!1,noHeight:!1,intervals:null,isMouseEntered:!1,direction:-1,init:function(){this.initBtnList(),this.initActive(),this.initIntervals(),this.initApplyClass(),this.resetInterval(),this.noHeight||this.fitTabHeight(),this.btns.$on("click",this.onClickBtn,this),this.tabs.$on("click",this.onClickTab,this),this.el.attr("data-slider-index",this.index)},initBtnList:function(){if(this.btns.length<this.tabs.length){for(var a=this.btns.length;a<this.tabs.length;a++){var b=this.tabs.eq(a)[0].className.replace(/\s*(?:-?active)\s*/g,"");if(b){var c=b+"-btn";this.btnWrap.append("<li class="+c+"></li>")}else this.btnWrap.append("<li></li>")}this.applyRef("btns")}},initActive:function(){var a=this.tabs.filter(".active").index();-1===a&&(a=0),this.tabs.css("transition","none"),this.setIndex(a,!0),this.tabs.css("transition","")},initIntervals:function(){if(this.interval){this.intervals=[];for(var a=0;a<this.tabs.length;a++)this.intervals[a]=Number(this.tabs.eq(a).data("interval"))||this.interval;this.mouseenterCollapse||(this.el.$on("mouseenter",this.onMouseEnter,this),this.el.$on("mouseleave",this.onMouseLeave,this))}},onMouseEnter:function(a){this.isMouseEntered=!0,this.el.addClass("slider-lock"),this.timeoutId&&(clearTimeout(this.timeoutId),this.timeoutId=0)},onMouseLeave:function(a){this.isMouseEntered=!1,this.el.removeClass("slider-lock"),this.el.addClass("slider-before-unlock"),this.el[0].offsetWidth,this.el.removeClass("slider-before-unlock"),this.resetInterval()},initApplyClass:function(){this.applyClassTo&&(this.applyClassToEl=a(this.applyClassTo),this.applyClassToEl=this.applyClassToEl.length?this.applyClassToEl:null),this.handleClassApplying()},timeoutId:0,resetInterval:function(){this.interval&&(this.timeoutId&&clearTimeout(this.timeoutId),this.intervals&&(this.timeoutId=setTimeout(this.nextTab.bind(this),this.intervals[this.index])))},stopInterval:function(){clearTimeout(this.timeoutId),this.timeoutId=0},fitTabHeight:function(){var a=this.tabs.eq(this.index);a.length>0&&a[0].offsetHeight!==this.tabWrap.height()&&a[0].offsetHeight>0&&this.tabWrap.height(a[0].offsetHeight)},onClickBtn:function(a){var b=this.btns.indexOf(a.currentTarget);this.setIndex(b)},onClickTab:function(b){var c=a(b.currentTarget).index();this.setIndex(c)},nextTab:function(){var a=(this.index+1)%this.tabs.length;this.setIndex(a)},lastAppliedClass:"",setIndex:function(a,b){if(a!==this.index){this.direction=a>this.index?1:-1;var c=this.index,d=this.tabs.eq(c);d.$trigger("tabinactive",d);var e=this.tabs.eq(a),f=this.tabs.length;this.index=a;var g=(a+1+f)%f,h=(a-1+f)%f;this.btns.removeClass("active").eq(a).addClass("active"),this.tabs.removeClass("last-active").removeClass("prev-active").removeClass("next-active"),!b&&this.el.hasClass("slider-pan")?(this.tabs.css("transition","none"),1===this.direction?this.tabs.eq(a).addClass("next-active"):this.tabs.eq(a).addClass("prev-active"),this.tabs.each(function(a,b){b.offsetWidth}),this.tabs.css("transition",""),this.tabs.eq(a).removeClass("prev-active").removeClass("next-active"),1===this.direction?this.tabs.eq(c).addClass("prev-active"):this.tabs.eq(c).addClass("next-active")):(this.tabs.length>2&&this.tabs.eq(h).addClass("prev-active"),this.tabs.eq(g).addClass("next-active")),this.tabs.eq(c).removeClass("active").addClass("last-active"),this.tabs.eq(a).addClass("active"),this.el.attr("data-slider-index",a),this.noHeight||this.fitTabHeight(),this.isMouseEntered||this.resetInterval(),this.onSetIndex(a),this.trigger("toggle",e),e.$trigger("tabactive",e),this.handleClassApplying(),this.handleActiveApplying();var h=(a-1+this.tabs.length)%this.tabs.length,g=(a+1)%this.tabs.length}},initActiveClass:function(){this.toggleActiveTo&&(this.toggleActiveToEl=a(this.toggleActiveTo),this.toggleActiveToEl=this.toggleActiveToEl.length?this.toggleActiveToEl:null),this.handleActiveApplying()},handleActiveApplying:function(){if(this.toggleActiveToEl){var a=this.toggleActiveToEl.children();a.removeClass("active"),a.eq(this.index).addClass("active")}},handleClassApplying:function(){if(this.applyClassToEl){this.lastAppliedClass&&(this.applyClassToEl.removeClass(this.lastAppliedClass),this.btnWrap.removeClass(this.lastAppliedClass),this.lastAppliedClass="");var a=this.tabs.eq(this.index).attr("data-class-to-apply");a||(a=this.tabs[this.index].className.replace(/\s*(?:\w+-)?active/g,"").trim(),a&&(a+="-style")),a&&(this.lastAppliedClass=a,this.applyClassToEl.addClass(a),this.btnWrap.addClass(this.lastAppliedClass))}},onSetIndex:function(){}}),a.register("slider","switcher",{selector:".slider",props:["no-pan","slider-group"],noPan:!1,sliderGroup:!1,ref:{bodyWrap:".slider-body",btnWrap:".slider-btn",tabWrap:".slider-tab",btns:".slider-btn > li",tabs:".slider-tab > li",prevEl:".slider-prev",nextEl:".slider-next",leftEl:".slider-img-left",rightEl:".slider-img-right"},init:function(){this.sliderGroup&&this.initSliderGroup(),this.initCollapseTabs(),this.callSuper("switcher"),this.initActiveClass(),this.handlePanStyle(),this.prevEl.$on("click",this.prevTab,this),this.nextEl.$on("click",this.nextTab,this),this.leftEl.$on("click",this.prevTab,this),this.rightEl.$on("click",this.nextTab,this),this.tabWrap.onPan(this.onPan.bind(this));var a=this.tabWrap.dir("fit");a&&(a.fitDirection="h")},handlePanStyle:function(){this.el.hasClass("slider-pan")||!this.btns.length||this.noPan||a.defer(function(){a.onToggleMobile(function(){this.el.addClass("slider-pan")},function(){this.el.removeClass("slider-pan")},this)},this)},initCollapseTabs:function(){a(window).width()<768&&this.mobileCollapse&&(this.tabs.each(function(b,c){var c=a(c),d=c.children(":last");c.after(a("<li></li>").append(d))}),this.applyRef())},initSliderGroup:function(){var a=this.tabs.children(),b=a.length,c=a.width(),d=this.el.width();if(!(d>=c*b)){for(var e=Math.floor(d/c),f=Math.ceil((b-e)/e),g=0;f>g;g++){this.tabWrap.append("<li></li>");for(var h=0;b-e*(g+1)>h;h++){var i=a.eq(e*(g+1)+h);this.tabWrap.find(">li:last-child").append(i)}}this.applyRef()}},prevTab:function(){var a=(this.index-1+this.tabs.length)%this.tabs.length;this.setIndex(a)},onPan:function(a){"l"===a?this.prevTab():"r"===a&&this.nextTab()}}),a.register("photo-slider","slider",{selector:".photo-slider",maxTopMoved:500,minScale:.33,minOpacity:.7,angleAvailable:260,useShade:!0,activeElBottomAlign:!0,activeElTop:0,useRoundLayout:!0,init:function(){this.useShade&&(this.tabs.each(function(b,c){a(c).append('<div class="slider-shade"></div>')}),this.shades=this.el.find(".slider-shade")),this.initBtnList(),this.initActive(),this.resetPosition(),this.prevEl.$on("click",this.prevTab,this),this.nextEl.$on("click",this.nextTab,this),this.tabWrap.onPan(this.onPan.bind(this)),this.tabs.$on("click",this.onClickTab,this),a(window).$on("resize",this.resetPosition,this)},resetPosition:function(){var a=Math.PI/180,b=this.tabs.length,c=this.index,d=this.angleAvailable/(b-2),e=(360-this.angleAvailable)/2*a,f=this.el[0].offsetWidth,g=this.tabs[0].offsetWidth;this.tabs.eq(c).css("z-index",1e3).css("transform","translateY({0}px)".format(this.activeElTop)).css("opacity",""),this.useShade&&this.shades.eq(c).css("opacity",0);for(var h=1;b>h;h++){var i=(c+h)%b,j=this.tabs.eq(i),k=e+(h-1)*d*a,l=this.useRoundLayout?1:Math.cos(4*k)/15+14/15,m=(1-this.minScale)*(1+Math.cos(k))/2+this.minScale,n=-this.maxTopMoved/2*((this.activeElBottomAlign?Math.cos(e):1)-Math.cos(k)*l),o=(f-g)*Math.sin(k)*.5*l,p=(1-this.minOpacity)*(1+Math.cos(k))/2+this.minOpacity;j.css("transform","translate({left}px, {top}px) scale({scale})".format({left:o,top:n,scale:m})),j.css("z-index",Math.floor(1e3*m)),this.useShade?this.shades.eq(i).css("opacity",1-p):j.css("opacity",p)}},onSetIndex:function(){this.resetPosition()},onClickTab:function(b){if(window.innerWidth>768){var c=a(b.target).closest("li").index();this.setIndex(c)}}}),a.register("rating",{selector:".rating",template:'		<div class="rating" data-rating="4.5">			<div class="rating-count">{@@reviews} ({{this.reviewCount}})</div>			<div class="rating-stars">				<div class="rating-background-stars">					<icon type="star"></icon>					<icon type="star"></icon>					<icon type="star"></icon>					<icon type="star"></icon>					<icon type="star"></icon>				</div>				<div class="rating-current-stars">					<icon type="star"></icon>					<icon type="star"></icon>					<icon type="star"></icon>					<icon type="star"></icon>					<icon type="star"></icon>				</div>			</div>		</div>	',ref:{starWrap:".rating-stars",backgroundEl:".rating-background-stars",currentEl:".rating-current-stars",textEl:".rating-text",valueEl:'[itemprop="ratingValue"]',countEl:'[itemprop="ratingCount"]',thanksEl:".rating-thanks"},rating:0,reviewCount:0,posturl:"",selectable:!1,size:"normal",autoSet:!1,init:function(){this.selectable&&this.el.addClass("selectable"),"small"===this.size&&this.el.addClass("rating-sml"),this.ratingLabels=c("rating_labels").split(";"),this.isOld&&(this.selectable=this.el.hasClass("selectable"),this.posturl=this.posturl||this.el.closest("[data-posturl]").data("posturl"),this.rating||(this.rating=Number(this.valueEl.text())),this.starWrap.append('<div class="rating-background-stars"><i></i><i></i><i></i><i></i><i></i></div><div class="rating-current-stars"><i class="active"></i><i class="active"></i><i class="active"></i><i class="active"></i><i class="active"></i></div>'),this.applyRef()),this.setValue(this.rating);var a=this.starWrap.find(".icon, i");a.$on("mouseenter",this.onEnterStar,this),a.$on("mouseleave",this.onLeaveStar,this),a.$on("click",this.onClickStar,this),this.initArticleRating()},initArticleRating:function(){this.posturl&&this.on("select",function(b){this.el.removeClass("selectable").attr("disabled","disabled"),this.selectable=!1,a.ajax({type:"POST",url:a.nocache(this.posturl),dataType:"json",data:{rating:b},success:function(a){1==a.state&&(this.countEl.text((parseInt(this.countEl.text())||0)+1),this.thanksEl.show())}.bind(this)})},this)},setValue:function(a){a=Number(a),this.rating=a;var b=a,c=a-Math.floor(a),d=Math.floor(a)+.5;c>0&&(b=d+22*(a-d)/32),this.currentEl.width(20*b+"%"),this.textEl.text(this.ratingLabels[Math.floor(a-1e-4)]),this.valueEl.text(a)},onEnterStar:function(b){if(this.selectable){var c=a(b.currentTarget).index(),d=this.ratingLabels[c];this.textEl.text(d),this.backgroundEl.find("i, .icon").slice(0,c+1).addClass("active")}},onLeaveStar:function(a){this.selectable&&(this.textEl.text(this.ratingLabels[Math.floor(this.rating-1e-4)]),this.backgroundEl.find("i, .icon").removeClass("active"))},onClickStar:function(b){if(this.selectable){var c=a(b.currentTarget).index(),d=c+1;this.autoSet&&this.setValue(d),this.trigger("select",c+1)}}}),a.register("viewer","win",{selector:".viewer",template:'<div class="viewer"><div class="viewer-body"></div></div>',target:"body",mask:!0,ref:{body:".viewer-body"},onReady:function(){this.maskEl.addClass("video-viewer-mask")},show:function(){this.el.show();var b=this.width,c=this.height,d=a(window).width(),e=a(window).height(),f=d-30,g=e-30;b>f&&(c=c*f/b,b=f),c>g&&(b=b*g/c,c=g),this.el.width(b).height(c),this.body.attr("width",b).attr("height",c),this.body.width(b).height(c),this.el.addClass("active"),a("body").addClass("body-fixed"),this.trigger("show")},hide:function(){this.el.removeClass("active"),a("body").removeClass("body-fixed"),this.trigger("hide"),setTimeout(function(){this.destroy()}.bind(this),300)}}),a.register("video-viewer","viewer",{video:"",poster:"",width:640,height:360,useIframe:!1,template:function(){return this.useIframe?'<div class="viewer video-viewer"><iframe class="viewer-body" src="{video}" allowfullscreen></iframe></div>'.format(this):'<div class="viewer video-viewer"><video class="viewer-body" autoplay controls poster="{poster}" width="100%"><source src="{video}" type="video/mp4"></source></video></div>'.format(this)}}),a.registerDir("open-video",{selector:"[data-video], .fancybox-media",ref:{orgVideo:"video"},props:["video","video-width","video-height"],videoWidth:640,videoHeight:360,video:"",skipClass:"",init:function(){this.video=this.video||this.el.attr("href"),/youtube\.com\/watch\?v=[\w-]+/.test(this.video)&&(this.video=this.video.replace(/watch\?v=([\w-]+)(&?)/,function(a,b,c){return"embed/"+b+(c?"?":"")})),/youtube\.com/.test(this.video)&&(this.video.includes("?")?this.video.includes("autoplay=1")||(this.video+="&autoplay=1"):this.video+="?autoplay=1"),this.el.$on("click",this.onClickEl,this)},onClickEl:function(b){if(b.preventDefault(),a(window).width()<=768)return void open(this.video);if(!this.skipClass||!a(b.target).closest(this.skipClass).length){var c=this.el.find("video"),d=!1;c.length?(this.video=this.video||c[0].currentSrc,this.poster=c[0].poster||"",c.trigger("pause")):this.video.startsWith("http")&&(d=!0),a.newCom("video-viewer",{video:this.video,poster:this.poster,width:this.videoWidth,height:this.videoHeight,useIframe:d}).show()}}}),a.register("report-video-win","win",{template:function(){return'<div class="win report-win"><div class="win-head">'+(this.title||"{@@report}")+'</div><div class="win-body"><label class="report-win-label"><span>{@@email}:</span><input type="email" name="email" required pattern="^[\\w-]+(?:\\.[\\w-]+)*@[\\w-]+(?:\\.[\\w-]+)+$"></label><label class="report-win-label"><span>{@@reason}:</span><input type="text" name="reason" required></label></div><div class="win-foot"><button class="submit" type="primary">{@@submit}</button></div></div>'},id:"",email:"",title:"",target:"body",autoDestroy:!0,notUseJson:!1,ref:{emailEl:"[name=email]",submitEl:".submit"},init:function(){this.email&&this.emailEl.val(this.email),this.submitEl.$on("click",this.onSubmit,this)},getURL:function(){return a.nocache(apower.getWPPath()+"/wp-admin/admin-ajax.php?action=videograbber_video&type=report_video")},getPost:function(){var a=this.el.formObj({post_id:this.id});return a},onSubmit:function(){var b=this.getURL(),c=this.notUseJson?this.getPost():JSON.stringify(this.getPost());this.el.checkValidity()&&(a.ajax({type:"POST",url:a.nocache(b),data:c,dataType:"json",success:this.onSubmitted.bind(this),error:this.onSubmitError.bind(this)}),this.submitEl.addClass("btn-loading"))},onSubmitted:function(b){this.submitEl.removeClass("btn-loading"),b&&1==b.state?(a.msg.success(c("thanks_report")),this.hide()):a.msg.error(c("submit_failed"))},onSubmitError:function(b){this.submitEl.removeClass("btn-loading"),a.msg.error(c("submit_failed"))}}),a.registerDir("report-video",{selector:"[data-report-video]",props:["id"],init:function(){this.el.$on("click",this.onClickEl,this)},onClickEl:function(b){a.newCom("report-video-win",null,{id:this.id}).show()}}),a.register("image-viewer","viewer",{width:80,height:80,image:"",template:'<div class="viewer image-viewer"><img class="viewer-body"></div>',props:["image"],init:function(){this.callSuper("viewer"),a.preloadImage(this.image,function(a){return a?(this.body.attr("src",this.image),this.width=a.naturalWidth,this.height=a.naturalHeight,void this.show()):void this.destroy()},this)}}),a.registerDir("open-image",{selector:"[data-image], .fancybox",props:["image"],init:function(){this.image=this.image||this.el.attr("href"),this.el.$on("click",this.onClickEl,this)},onClickEl:function(b){b.preventDefault(),a.newCom("image-viewer",{image:this.image}).show()}}),a.register("share-win","win",{props:["share-url"],autoDestroy:!0,template:function(){if("zh"===apower.lang)var a='<li title="ÂàÜ‰∫´Âà∞Ë±ÜÁì£" class="douban"></li><li title="ÂàÜ‰∫´Âà∞QQÁ©∫Èó¥" class="qzone"></li><li title="ÂàÜ‰∫´Âà∞Êñ∞Êµ™ÂæÆÂçö" class="weibo"></li><li title="Â§çÂà∂Âà∞ÊµèËßàÂô®" class="copy-link" data-copy="'+location.href+'"></li>';else var b="ja"===apower.lang?"hatena":"pinterest",a='<li class="facebook"></li><li class="twitter"></li><li class="google"></li><li class="'+b+'"></li>';return apower.trans('<div class="win share-win"><h2 class="win-head">{@@share}</h2><ul class="win-body" data-share>{0}</ul></div>').format(a)},init:function(){this.callSuper("win")}}),a.registerDir("open-share",{selector:"[data-open-share]",props:["share-url"],init:function(){this.el.$on("click",this.onClickEl,this)},onClickEl:function(b){a.newCom("share-win",{shareURL:this.shareURL}).show()}}),a.register("fixed-share",{template:function(){var b=a.getDirective("bind-share").prototype.links,c=this.hasWeixin&&b.weixin&&b.weixin.img;if("zh"===apower.lang)return'<div class="counted-share-vertical" data-share><ul>'+(c?'<li class="share-vertical-weixin"><div></div></li>':"")+'<li class="share-vertical-douban"><div></div></li><li class="share-vertical-qzone"><div></div></li><li class="share-vertical-weibo"><div></div></li><li class="share-vertical-tencent"><div></div></li><li class="share-vertical-youdao"><div></div></li></ul><div class="share-vertical-hidebar"></div></div>';var d="ja"===apower.lang?"hatena":"pinterest";return'<div class="counted-share-vertical" data-share><ul><li class="share-vertical-google"><div>-</div></li><li class="share-vertical-facebook"><div>-</div></li><li class="share-vertical-twitter"><div>{@@share}</div></li><li class="share-vertical-'+d+'"><div>-</div></li><li class="share-vertical-linkedin"><div>-</div></li></ul><div class="share-vertical-hidebar"></div></div>'},target:"body",props:["share-url"],shareURL:"",useShareCount:!0,hasWeixin:!1,init:function(){this.el.find(".share-vertical-hidebar").$on("click",function(a){this.el.toggleClass("collapsed")},this),this.useShareCount&&"zh"!==apower.lang&&apower.sharer.getShareCount(this.shareURL,function(a){for(var b in a){var c=a[b],d=this.el.find(".share-vertical-"+b+" div");c>0?d.text(c):(d.text(""),this.el.find(".share-vertical-"+b).css("background-position","center"))}},this)}}),a.register("comment-form",{selector:".comment-form",ref:{inputs:"input, textarea",submitEl:".submit",cancelEl:".cancel-reply",parentIdEl:'[name="comment_parent"]',authorEl:"[name=author]",emailEl:"[name=email]",contentEl:"[name=comment]"},init:function(){this.leaveCommentEl=this.el.closest(".leave-comment"),this.commentEl=this.leaveCommentEl.siblings(".comment"),this.initForm(),this.initValue()},initForm:function(){this.inputs.$on("input",function(b){b.target.value?a(b.target).addClass("touched"):a(b.target).removeClass("touched")}),this.inputs.$on("focus",function(b){a(b.target).parent().addClass("active")}),this.inputs.$on("blur",function(b){var c=a(b.target);c.val()||c.parent().removeClass("active")}),this.contentEl.$on("keydown",function(a){13===a.keyCode&&(a.preventDefault(),this.el.checkValidity()&&this.doSubmit())},this),this.submitEl.$on("click",function(a){a.preventDefault(),this.el.checkValidity()&&this.doSubmit()},this),this.cancelEl.$on("click",function(a){a.preventDefault(),this.inputs.blur().removeClass("touched"),this.el.appendTo(this.leaveCommentEl),this.parentIdEl.val("0"),this.commentEl.find(".comment-replying").removeClass("comment-replying")},this)},initValue:function(){"Anonymous"===this.authorEl.val()&&this.authorEl.val(""),"anonymous@apowersoft.com"===this.emailEl.val()&&this.emailEl.val(""),this.contentEl.val("")},setParentId:function(a){this.parentIdEl.val(a)},doSubmit:function(){var b=this.el.attr("action");a.ajax({type:"POST",url:a.nocache(b),data:this.el.formData(),processData:!1,contentType:!1,dataType:"text",success:this.onSubmitted.bind(this),error:this.onSubmitError.bind(this)}),this.contentEl.blur().attr("disabled","disabled"),this.submitEl.addClass("btn-loading")},onSubmitted:function(b){if(this.contentEl.blur().removeAttr("disabled"),this.submitEl.removeClass("btn-loading"),"string"==typeof b){var d=b.select(/^\s*<p>(.+?)<\/p>\s*$/,1);if(d)return void a.msg.alert(d);try{b=JSON.parse(b)}catch(e){b={}}}var f=this.authorEl.val(),g=this.contentEl.val(),h=this.el.closest(".comment-item");h=h.length?h:null,b.comment_author=b.comment_author||f||c("anonymous"),b.comment_content=b.comment_content||g,b.comment_date=b.comment_date||a.formatDate(new Date),a(".comment").each(function(c,d){a(d).com().onNewComment(b,h)}),this.initValue(),this.inputs.removeClass("touched").parent().removeClass("active"),this.trigger("submitted")},onSubmitError:function(b){this.contentEl.blur().removeAttr("disabled"),this.submitEl.removeClass("btn-loading");var d=(b.responseText||"").select(/<p>(.+?)<\/p>/,1);a.msg.alert(d||c("submit_failed"))},commentNumberPlus:function(){var b=Number(a(".comment-number span").eq(0).text())||0;b++,a(".comment-count").text("("+b+")"),a(".comment-number span").text(b)}}),a.register("comment",{selector:".comment",ref:{inputs:"input",listEl:" > ul",loadMoreEl:".load-more"},data:{},props:["use-ago-time"],page:0,paging:5,pageCount:1,pagingMode:!1,useAgoTime:!1,init:function(){this.loadMoreMode=!!this.loadMoreEl.length,this.form=this.el.siblings(".leave-comment").find(".comment-form"),this.pagingMode=!this.el.closest(".comment-win").length&&!this.loadMoreMode,this.initPermlink(),this.initPageInfo(),this.useAgoTime&&this.initPublishedTime(),this.pagingMode?this.initPaging():this.loadMoreMode?this.initLoadMore():this.initWin(),this.el.$on("click",this.onClickLike,this),this.el.$on("click",this.onClickReply,this)},initPermlink:function(){if(/comment=\d+/i.test(location.search)){var b=location.search.match(/comment=(\d+)/i)[1],c=a("#comment-"+b);c.length&&(location.hash="#comment-"+b)}},onClickLike:function(b){var c=a(b.target).closest(".comment-like, .comment-dislike"),d=c.is(".comment-like"),e=c.parent().children(".comment-like, .comment-dislike");if(c.length){e.addClass("comment-liked");var f=c.closest("[data-id]").data("id"),g={comment_ID:f,vote_type:d?"1":"-1",action:"wc_vote_via_ajax"};a.ajax({type:"POST",url:a.nocache(apower.getWPPath()+"/wp-admin/admin-ajax.php"),data:g,dataType:"json",success:function(a){1==a.code?c.text((Number(c.text())||0)+1):-1==a.code&&e.removeClass("comment-liked")}})}},onClickReply:function(b){var c=a(b.target).closest(".comment-reply");if(c.length){var d=this.form,e=c.closest("[data-id]").data("id"),f=c.closest(".comment-self");d.com().setParentId(e),a(window).width()>768?(c.closest(".comment-actions").before(d),this.el.find(".comment-replying").removeClass("comment-replying"),f.addClass("comment-replying")):a.newCom("mobile-comment-form").show()}},initPageInfo:function(){this.pagingWrap=this.el.find(".paging"),this.prevEl=this.pagingWrap.find(".prev"),this.nextEl=this.pagingWrap.find(".next"),this.page=Math.max(parseInt(this.pagingWrap.find("li.active").text())-1||0,0),this.pageCount=parseInt(this.pagingWrap.data("page-count"))||1,this.listEl.length||(this.listEl=a('<ul id="comment-list"></ul>'),this.el.find("h2").after(this.listEl)),this.data[this.page]=this.listEl.children()},initPaging:function(){this.loadEl=a('<div class="loading" hidden><div><div></div></div></div>').appendTo(this.el),this.pagingWrap.$on("click",function(b){var c=a(b.target).closest("li");if(c.length){var d=0;d=c.is(".prev")?this.page-1:c.is(".next")?this.page+1:Number(c.text())-1,this.loadPageData(d)}},this)},initPublishedTime:function(){this.el.find(".comment-time span").each(function(b,c){a(c).text(apower.getAgoTypeTime(a(c).text()))}.bind(this))},initWin:function(){this.win=this.el.closest(".comment-win").com(),this.win.on("ready",function(){this.win.maskEl.addClass("comment-win-mask"),this.loadEl=a('<div class="loading-more"><div></div></div>').appendTo(this.win.body),0!==this.page&&this.loadPageData(0),this.win.body.$on("scroll",this.onBodyScroll,this)},this)},initLoadMore:function(){1==this.pageCount&&this.loadMoreEl.hide(),this.loadMoreEl.find("> div").$on("click",this.onClickLoadMore,this)},onClickLoadMore:function(){this.loadPageData(this.page+1)},onBodyScroll:function(){var a=this.win.body;this.page<this.pageCount-1&&!this.loadEl.hasClass("active")&&a[0].scrollTop>=a[0].scrollHeight-a[0].clientHeight&&this.loadPageData(this.page+1)},loadPageData:function(b){if(this.data[b])this.page=b,this.onLoadData(this.data[b]);else{var c={post_id:a('[name="comment_post_ID"]').val(),action:"wc_load_more_comments",offset:b*this.paging,per_page:this.paging};this.inputs.map(function(b,d){c[a(d).attr("name")]=a(d).val()}),this.pagingMode?this.loadEl.show():this.loadMoreMode?this.loadMoreEl.addClass("active"):this.loadEl.addClass("active"),a.ajax({type:"POST",url:apower.getWPPath()+"/wp-admin/admin-ajax.php",data:c,dataType:"json",success:function(a){this.pagingMode?this.loadEl.hide():this.loadMoreMode?(this.loadMoreEl.removeClass("active"),this.loadMoreEl.com()&&this.loadMoreEl.com().stop(),(!a.comments||a.comments.length<this.paging)&&this.loadMoreEl.hide()):this.loadEl.removeClass("active"),this.page=b,this.pageCount=Math.ceil(a.parent_count/this.paging)||this.pageCount,this.data[b]=a.comments,this.onLoadData(a.comments)}.bind(this)})}},generateHTML:function(a){if(!a)return"";for(var b=[],d=0;d<a.length;d++){var e=a[d],f=apower.user&&apower.user.getId()==e.comment_uid,g=f?apower.user.getAvatar():e.avatar||e.avatar_url,h=g?" has-portrait":"",i=this.useAgoTime?apower.getAgoTypeTime(e.comment_date||e.comment_time):e.comment_date,j=e.comment_author||e.nickname,k=('<li class="comment-item" data-id="{comment_ID}" id="comment-{comment_ID}"><div class="comment-self" itemprop="comment" itemscope itemtype="http://schema.org/Comment"><div class="comment-portrait'+h+'"><img src="'+g+'"></div><div class="comment-author" itemprop="author">'+j+'</div><a class="comment-time" itemprop="datePublished" href="?comment={comment_ID}">'+i+'</a><div class="comment-text" itemprop="text">{comment_content}</div><div class="comment-actions"><div class="comment-like" itemprop="upvoteCount">{like}</div><div class="comment-dislike" itemprop="downvoteCount">{dislike}</div><div class="comment-reply-count">{child_count}</div><div class="comment-reply">'+c("reply")+'</div></div></div><ul class="comment-reply-items">{child}</ul></li>').format(e).format({
child:this.generateHTML(e._child),child_count:e._child?e._child.length:0});b.push(k)}return b.join("")},onLoadData:function(b){if(this.el.find(".cancel-reply").click(),this.pagingMode){this.listEl.empty();var c=this.page,d=this.paging,e=this.pageCount,f=Math.max(0,c-Math.floor((d-1)/2)),g=Math.min(e,f+d);g===e&&(f=Math.max(0,g-d)),this.pagingWrap.find("li").not(".prev, .next").remove();for(var h=f;g>h;h++){var i=a("<li>"+(h+1)+"</li>");h===c&&i.addClass("active"),this.nextEl.before(i)}c>0?this.prevEl.removeAttr("disabled"):this.prevEl.attr("disabled","disabled"),e-1>c?this.nextEl.removeAttr("disabled"):this.nextEl.attr("disabled","disabled")}if(Array.isArray(b)){a(this.generateHTML(b)).appendTo(this.listEl)}else{b.clone().appendTo(this.listEl)}},onNewComment:function(b,d){var e="video"!==apower.pageType,f="";e&&(f='<div class="comment-await">'+c("success_to_review")+"</div>");var g="";b.comment_id?g=apower.trans('<div class="comment-actions"><div class="comment-like" itemprop="upvoteCount">0</div><div class="comment-dislike" itemprop="downvoteCount">0</div><div class="comment-reply-count">0</div><div class="comment-reply">{@@reply}</div></div>'):b.comment_id=Date.now();var h=this.useAgoTime?apower.getAgoTypeTime(b.comment_date||b.comment_time):b.comment_date,i=apower.user?apower.user.getAvatar():"",j=i?" has-portrait":"",k='<li class="comment-item" data-id="{comment_id}" id="comment-{comment_id}"><div class="comment-self" itemprop="comment" itemscope itemtype="http://schema.org/Comment"><div class="comment-portrait'+j+'"><img src="'+i+'"></div><div class="comment-info"><div class="comment-author" itemprop="author">{comment_author}</div><a class="comment-time" itemprop="datePublished">'+h+'</a></div><div class="comment-text" itemprop="text">{comment_content}</div>'+f+g+"</div></li>";this.el.removeClass("no-comment");var l=a(k.format(b));if(d&&!e){var m=d.find("> .comment-reply-items");m.length||(m=a('<ul class="comment-reply-items"></ul>').appendTo(d)),m.prepend(l)}else this.listEl.prepend(l);this.data[0]&&this.data[0].add&&(this.data[0]=l.add(this.data[0]))}}),apower.getAgoTypeTime=function(a){var b=new Date,c=new Date(a),d=b-c+60*b.getTimezoneOffset()*1e3,e={second:1e3,minute:6e4,hour:36e5,day:864e5,week:6048e5,month:2592e6,year:31536e6},f="second",g=1;for(var h in e){var i=d/e[h];if(!(i>1))break;f=h,g=Math.floor(i)}var j=(g>1?"some_{0}s_ago":"one_{0}_ago").format(f);return apower.tr(j,g)},a.registerDir("open-comment",{selector:"[data-open-comment], .feature-comment",init:function(){this.el.$on("click",function(){this.showCommentWin()},this)},showCommentWin:function(){if(a(".comment-win").length)a(".comment-win").com().show();else{var b=a.newCom("win");b.maskEl.addClass("comment-win-mask"),b.el.addClass("comment-win");a(".comment");b.body.append(a(".leave-comment").clone()),b.body.append(a(".comment").clone()),b.body.append(a(".paging").clone()),b.body.find(".comment h2").appendTo(b.head),b.body.find(".comment .comment-form").appendTo(b.body.find(".leave-comment")),b.body.find(".comment .comment-replying").removeClass("comment-replying");var c=b.el.find(".comment-number"),d=b.el.find(".win-body");c.$on("click",function(){var a=b.el.find(".comment").position().top-150||0;d[0].scrollTo(0,a)},this),b.body.applyCom(),b.show()}}}),a.register("mobile-comment-form",{ref:{inputs:"input, textarea",submitEl:".submit",cancelEl:".cancel",loadEl:".loading"},template:'<form class="mobile-comment-form" action="" method="post"><div class="wrapper"><div class="title">{@@comments}</div><textarea placeholder="{@@write_your_review}" name="comment" required maxlength="1024"></textarea><input type="hidden" name="author" value="Anonymous"><input type="hidden" name="email" value="anonymous@apowersoft.com"><div class="win-foot"><button class="submit">{@@submit}</button><button class="cancel">{@@cancel}</button></div></div><div class="loading" hidden><div><div></div></div></div></form>',target:"body",init:function(){this.oldForm=a(".comment-form").eq(0),this.inputs.$on("input",function(b){""!==a(b.target).val()?this.submitEl.addClass("active"):this.submitEl.removeClass("active")},this),this.cancelEl.$on("click",function(a){a.preventDefault(),this.destroy()},this),this.loadEl.$on("click",function(){this.destroy()},this),this.el.$on("submit",function(b){b.preventDefault(),this.loadEl.show(),this.oldForm.com().inputs.each(function(b,c){a(c).val(this.el.find("[name="+c.name+"]").val())}.bind(this)),this.oldForm.com().doSubmit(),this.oldForm.com().on("submitted",this.onSubmitted,this)},this)},onSubmitted:function(){this.destroy()},show:function(){this.el.show().find("textarea").focus()},onDestroy:function(){this.oldForm.com().off("submitted",this.onSubmitted,this)}}),apower.scroller=a.registerOnce(document,{downFns:[],upFns:[],lastScrollTop:0,init:function(){this.lastScrollTop=a("html").scrollTop()||a("body").scrollTop(),this.el.$on("scroll",this.onDomScroll,this),setTimeout(function(){this.trigger("scroll",this.lastScrollTop),this.lastScrollTop>100&&this.trigger("down",this.lastScrollTop)}.bind(this),0),this.onDomScroll()},onDomScroll:function(b){var c=a("html").scrollTop()||a("body").scrollTop(),d=(a(window).width(),c<this.lastScrollTop?"up":"down");"up"===d?this.trigger("up",c):c>=100&&this.trigger("down",c),this.trigger("scroll",c,d),this.lastScrollTop=c}}),a.register("mobile-review",{template:'<div class="mobile-review"><div class="mobile-review-wrapper"><div class="mobile-comment-btn">{@@comments}</div><div class="mobile-review-btns"><div class="mobile-rating-btn"></div><div class="mobile-share-btn" data-open-share></div><div class="mobile-comment-count"></div></div></div></div>',target:"body",ref:{countEl:".mobile-comment-count",commentBtn:".mobile-comment-btn"},init:function(){var b=a(".comment-win");this.countEl.text(a(".comment-count").eq(0).text()),this.commentBtn.$on("click",function(b){a.newCom("mobile-comment-form").show()}),this.countEl.$on("click",function(b){a.com("open-comment").prototype.showCommentWin(),a(".comment-win-mask").css("bottom",this.el[0].offsetHeight)},this),apower.scroller.on("down",function(){b.length&&b.is(":visible")||this.el.hide()},this),apower.scroller.on("up",function(){this.el.show()},this)}}),a.register("review-form","win",{template:'<form class="win review-form"><h2 class="win-head">{@@write_your_review}</h2><div class="win-body"><div class="rating selectable" data-selectable data-auto-set><div class="rating-stars"></div><div class="rating-text"></div></div><div class="title"><input type="text" placeholder="{@@title}" name="title" maxlength="100"></div><div class="text"><textarea placeholder="{@@write_your_review}" name="review" maxlength="1024"></textarea></div><div class="name"><input type="text" placeholder="{@@name}" name="name" maxlength="100"></div><div class="email"><input type="email" placeholder="{@@email}" name="email" maxlength="100" pattern="^[\\w-]+(?:\\.[\\w-]+)*@[\\w-]+(?:\\.[\\w-]+)+$"><div class="invalid-text">{@@valid_email}</div></div></div><div class="win-foot"><button class="cancel">{@@cancel}</button><button class="submit" type="primary">{@@submit}</button></div></div>',ref:{inputs:"input, textarea",ratingEl:".rating",submitEl:".submit",cancelEl:".cancel"},autoDestroy:!0,rating:5,init:function(){this.callSuper("win"),this.ratingEl.com().setValue(this.rating),this.inputs.$on("input",function(b){b.target.value?a(b.target).addClass("touched"):a(b.target).removeClass("touched")}),this.inputs.$on("focus",function(b){a(b.target).parent().addClass("active")}),this.inputs.$on("blur",function(b){var c=a(b.target);c.val()||c.parent().removeClass("active")}),this.submitEl.$on("click",this.onSubmit,this),this.cancelEl.$on("click",this.onClickCancel,this)},onSubmit:function(b){if(b.preventDefault(),this.el.checkValidity()){var d=this.ratingEl.com().rating,e={related_id:apower.productId,type:apower.productType,action:"review",score:d,language:apower.lang,nocache:"1"};a.extend(e,this.el.formObj()),this.showLoading(),a.ajax({url:a.nocache("https://support.apowersoft.com/Api/review"),data:e,dataType:"jsonp",success:function(b){this.hideLoading(),"exist"===b.status?(a.msg.alert(c("already_reviewed")),this.hide()):"failed"===b.status?a.msg.alert(c("failed_to_review")):this.onReviewSuccess(b,d)}.bind(this)})}},onClickCancel:function(a){a.preventDefault(),this.hide()},onReviewSuccess:function(b,c){this.hide(),apower.reviewChecker.setAsReviewed();var d={id:b.id,score:c,add_time:a.formatDate(new Date)};a.extend(d,this.el.formObj()),(d.title||d.review)&&a(".review-win").com().onNewReview(d)}}),a.registerDir("open-review-form",{selector:"[data-open-review-form]",init:function(){this.el.$on("click",this.onClickEl,this)},onClickEl:function(){a.newCom("review-form").show();var b=a(".review").com();b?b.hide():null}}),a.registerDir("set-review-rating",{selector:".rating",init:function(){this.el.find(".rating-count").length&&this.el.com().on("select",this.onSelect,this)},onSelect:function(b){a.newCom("review-form",{rating:b}).show();var c=a(".review").com();c?c.hide():null}}),apower.reviewChecker=a.registerOnce({reviewResult:void 0,init:function(){apower.productId&&"1"==apower.productType&&(this.reviewResult=a.store.get("apower_reviewed_"+apower.productId),this.reviewResult&&this.addReviewThanks())},setAsReviewed:function(){this.reviewResult=!0,a.store.set("apower_reviewed_"+apower.productId,!0),this.addReviewThanks()},isReviewed:function(b,c){if(void 0!==this.reviewResult)b.call(c,this.reviewResult);else{var d={related_id:apower.productId,type:apower.productType,action:"is_review"};a.ajax({url:a.nocache("https://support.apowersoft.com/Api/review"),data:d,dataType:"jsonp",success:function(a){b.call(c,this.reviewResult=1==a.status)}.bind(this)})}},addReviewThanks:function(){var b=a(".rating:has(.rating-count)").not(".review-win .rating");b.append('<span class="rating-thanks" style="display: inline">'+c("thanks_rating")+"</span>")}}),a.register("review","win",{template:function d(){var b="5";b=a('[itemprop="ratingValue"]').length>0?a('[itemprop="ratingValue"]').eq(0).text():a(".rating").eq(0).attr("data-rating");var c=a('[itemprop="reviewCount"]').eq(0).text()||a(".rating-count").text().select(/\d+/,0)||0,d='<div class="win review-win"><div class="win-head"><h2>{@@product_reviews}</h2><div class="review-add-group"><div class="rating rating-sml" data-rating="'+b+'"><div class="rating-stars"></div><div class="rating-count"><span>'+c+'</span> {@@reviews}</div></div><div class="review-add" data-open-review>{@@add_your_review}</div></div></div><div class="win-body"><ul></ul></div></div>';return d},ref:{ratingEl:".rating",addEl:".review-add",listEl:".win-body > ul",ratingCountEl:".rating-count span"},page:-1,pageCount:1,paging:10,data:{},init:function(){this.callSuper("win"),this.loadEl=a('<div class="loading-more"><div></div></div>').appendTo(this.body),this.addEl.$on("click",this.onClickAdd,this),this.body.$on("click",this.onClickLike,this),this.body.$on("scroll",this.onBodyScroll,this),this.on("show",function(){-1===this.page&&this.loadPageData()},this)},onClickAdd:function(){this.hide(),a.newCom("review-form").show()},onClickLike:function(b){var c=a(b.target).closest(".review-like, .review-dislike"),d=c.is(".review-like"),e=c.parent().children(".review-like, .review-dislike");if(c.length){e.addClass("review-liked");var f=c.closest("[data-id]").data("id"),g={review_id:f,type:apower.productType,action:d?"approval":"oppose"};a.ajax({url:a.nocache("https://support.apowersoft.com/Api/review"),data:g,dataType:"jsonp",success:function(a){"exist"===a.status||("failed"===a.status?e.removeClass("review-liked"):c.text((Number(c.text())||0)+1))}})}},onBodyScroll:function(){var a=this.body;this.page<this.pageCount&&!this.loadEl.hasClass("active")&&a[0].scrollTop>=a[0].scrollHeight-a[0].clientHeight&&this.loadPageData()},loadPageData:function(){this.page++;var b={related_id:apower.productId,type:apower.productType,action:"get_review",start:this.page*this.paging,page_num:this.paging,language:apower.lang};this.loadEl.addClass("active"),a.ajax({url:"https://support.apowersoft.com/Api/review",data:b,dataType:"jsonp",jsonpCallback:"jQueryCallback",cache:!0,success:function(a){this.loadEl.removeClass("active"),this.pageCount=Math.ceil(a.total_count/this.paging),this.data[this.page]=a.all_review,this.onLoadData(this.data[this.page]),a.total_count>0&&this.ratingCountEl.text(a.total_count)}.bind(this)})},onLoadData:function(b,d){if(b&&b.length)for(var e='<li class="review-item" data-id="{id}"><div class="rating rating-sml" data-rating="{score}"><div class="rating-stars"></div><div class="rating-time">{add_time}</div></div><div class="review-content"><div class="review-text"><header>{title}</header><i>by {name}</i><p>{review}</p></div><div class="review-like-group"><div class="review-like">{approval_num}</div><div class="review-dislike">{oppose_num}</div></div></div></li>',f=0;f<b.length;f++){var g=b[f];"Anonymous"!==g.name&&g.name||(g.name=c("anonymous")||g.name);var h=e.format(g),i=a(h).applyCom();d?this.listEl.prepend(i):this.listEl.append(i)}},onNewReview:function(a){this.show(),a.approval_num=0,a.oppose_num=0,this.onLoadData([a],!0);var b=this.listEl.children("li:first-child");b.find(".review-like-group").remove(),b.find(".review-text").append('<div class="review-await">'+c("success_to_review")+"</div>"),b.css({background:"#99d6eb"}),b.width(),b[0].style.transition="background-color 1s linear",this.body[0].scrollTop=0,setTimeout(function(){b.css({background:"#fff"})},500)}}),a.registerDir("open-review",{selector:"[data-open-review], .rating-count",init:function(){this.el.$on("click",this.onClickEl,this)},onClickEl:function(){var b=a(".review-win").com()||a.newCom("review");b.show()}}),a.registerDir("mailto",{selector:".mailto, [data-mailto]",prop:"mailto",init:function(){var a=this.mailto||this.el.text();a=a.replace(/[%#]/,"@"),this.el.text(a),this.el.attr("href","mailto:"+a)}}),a.registerDir("env-href",{selector:"[android-href], [iphone-href], [mobile-href], [win-href], [mac-href]",init:function(){for(var b=this.selector.select(/\[(\w+)/g,1),c=0;c<b.length;c++){var d=b[c],e=this.el.attr(d+"-href"),f="is"+d[0].toUpperCase()+d.slice(1);if(e&&a.env[f]){this.el.attr("href",e);break}}}}),a.registerDir("env-text",{selector:"[android-text], [iphone-text], [mobile-text], [win-text], [mac-text]",init:function(){for(var b=this.selector.select(/\[(\w+)/g,1),c=0;c<b.length;c++){var d=b[c],e=this.el.attr(d+"-text")||this.el.data(d+"-text"),f="is"+d[0].toUpperCase()+d.slice(1);if(e&&a.env[f]){this.el.text(e);break}}}}),a.registerDir("right-bar",{selector:".right-bar",rates:{news:.5,share:-1,review:apower.productId&&"Order"!=apower.pageType?.5:-1,comment:-1,rocket:.5,download:.5,support:.5,weixin:0,faq:-1},visible:{},ref:{newsEl:".bar-news",rocketEl:".bar-rocket",faqEl:".bar-faq",weinxinEl:".bar-weixin",items:"> div"},els:null,init:function(){this.els={};for(var b in this.rates)this.els[b]=this.el.find(".bar-"+b);a(".comment").length&&("article"===apower.pageType?this.rates.comment=0:this.rates.comment=.5),"Order"===apower.pageType&&apower.productId&&a("[data-open-faq]").length&&(this.rates.faq=.5),"article"===apower.pageType&&(this.rates.download=0),this.initRocket(),this.initLayers(),this.initNews(),this.faqEl.$on("click",this.onClickFAQ,this)},initNews:function(){this.newsEl.$on("click",this.onClickNews,this)},onClickNews:function(){a(".download-win").com().show()},initRocket:function(){this.rocketEl.$on("click",this.onClickRocket,this),a(window).width()<768?apower.scroller.on("scroll",this.onMobileRocket,this):apower.scroller.on("scroll",this.onScroll,this)},onClickRocket:function(){a("html, body").animate({scrollTop:0},500)},onMobileRocket:function(){var b;b=a(".footer").length?a(".screenshots").length?a(".screenshots").offset().top:a(".footer").offset().top:0;var c=b-a(window).height(),d=a("body").scrollTop()||a("html").scrollTop();d>c?this.rocketEl.fadeIn(200):this.rocketEl.fadeOut(200)},onScroll:function(b){var c=a(window).height();for(var d in this.rates){var e=this.rates[d],f=this.els[d],g=!(0>e||c*e>b),h=!!this.visible[d];h!==g&&(g?f.stop().fadeIn(300):f.stop().fadeOut(300)),this.visible[d]=g}},initLayers:function(){var b,c=this;a.nextTick(function(){c.items.each(function(c,d){var e=a(d),f=e.dir("layer");f&&(f.align="l",d.style.display="block",f.gap=d.offsetWidth-this.el[0].offsetWidth+10,d.style.display="",f.on("show",function(){b&&b!==f&&b.layer.hide(),b=f}),f.on("hide",function(){b===f&&(b=null)}))}.bind(c))})},onClickFAQ:function(){var b=a("[data-open-faq]").dir("open-faq");b&&b.openFAQWithoutHash()}}),a.registerDir("baidu-search",{selector:"form.search, form.search-blank",ref:{inputEl:"[type=text]",siteEl:"[name=as_sitesearch]"},url:"https://www.baidu.com/s",init:function(){this.el.$on("submit",function(a){"zh"===apower.lang&&(a.preventDefault(),this.onBaiduSearch())},this)},onBaiduSearch:function(){var b=this.inputEl.val(),c=this.siteEl.val(),d=b+" site:"+c,e=a('<form action="{0}" target="_blank"><input type="hidden" name="wd" value="{1}"></form>'.format(this.url,d)).appendTo("body");e.submit(),e.remove()}}),a.register("online-form-menu",{selector:".online-form-menu",init:function(){this.displayInput=this.el.prev(),this.valueInput=this.el.siblings("input[type=hidden]"),this.displayInput.$on("keypress",function(a){a.preventDefault()},this),this.displayInput.$on("click",this.onClickDisplayInput,this),this.el.$on("click",this.onClickList,this)},onClickDisplayInput:function(){this.el.is(":visible")?this.closeList():this.el.stop().fadeIn(200),a("html").$on("mousedown",this.closeList,this)},closeList:function(b){b&&a(b.target).closest(this.el).length||(a("html").$off("mousedown",this.closeList,this),this.el.stop().fadeOut(200))},onClickList:function(b){var c=a(b.target).closest("li");c.siblings().removeClass("active"),c.addClass("active"),this.displayInput.val(c.text()),this.valueInput.val(c.attr("value")),this.closeList()}}),a.register("online-form","win",{template:function(){return'<div class="win online-form"><div class="win-head">{@@submit_ticket}</div><form action="" class="win-body"><label class="online-form-field"><span>{@@email}: </span><input type="email" name="email" placeholder="{@@email}" required pattern="^[\\w-]+(?:\\.[\\w-]+)*@[\\w-]+(?:\\.[\\w-]+)+$"><span class="online-form-required">*</span></label><label class="online-form-field"><span>{@@question_type}:</span><input type="text" class="online-form-select" placeholder="{@@select_problem_type}" required name="problem_tpye_text"><ul class="online-form-menu"><li value="1">{@@purchase_and_security}</li><li value="2">{@@registration_and_key_code}</li><li value="3">{@@using_the_product}</li><li value="4">{@@technical_issue}</li><li value="5">{@@refund}</li><li value="6">{@@suggestion_or_complaints}</li><li value="7">{@@business_cooperation}</li><li value="8">{@@others}</li></ul><input type="hidden" name="problem_type"><span class="online-form-required">*</span></label><label class="online-form-field"><span>{@@subject}: </span><input type="text" name="problem_subject" required placeholder="{@@subject}"><span class="online-form-required">*</span></label><label class="online-form-field"><span>{@@description}: </span><textarea name="problem_content" required></textarea><span class="online-form-required">*</span></label><label class="online-form-field online-form-attachment" style="display: none"><span class="online-form-attachment-title">{@@attachments}: </span><ul class="online-form-attachment-list"></ul></label><div class="online-form-field online-form-buttons"><button class="online-form-submit">{@@submit}</button><button class="online-form-cancel">{@@reset}</button><button class="online-form-file">{@@add_file}</button><button class="online-form-record" data-start-screen-recording="">{@@record}</button></div></form></div>'},ref:{fileEl:".online-form-file",submitEl:".online-form-submit",cancelEl:".online-form-cancel",recordEl:".online-form-record",fileWrap:".online-form-attachment",fileUl:".online-form-attachment-list",buttonCt:".online-form-buttons"},autoDestroy:!0,target:"body",baseHeight:640,init:function(){this.callSuper("win"),this.files=[],this.cancelEl.$on("click",this.onClickCancel,this),this.submitEl.$on("click",this.onClickSubmit,this),this.fileEl.$on("click",this.onClickAddFile,this),this.fileUl.$on("click",this.onClickFileUl,this),this.recordEl.$on("click",this.onClickRecord,this)},onShow:function(){this.recordEl[0].offsetTop>this.submitEl[0].offsetTop&&(this.buttonCt.addClass("online-form-buttons-align-right"),this.recordEl.after(this.fileEl))},onClickCancel:function(a){a.preventDefault(),this.body.find("input, textarea").val("")},onClickRecord:function(b){a(b.target).is("a")?b.stopPropagation():b.preventDefault()},onClickSubmit:function(a){a.preventDefault(),this.body.checkValidity()?(this.submitEl.addClass("btn-loading"),apower.uploadFiles(this.files,this.onAttachmentsUploaded.bind(this))):this.body.find("input, textarea").addClass("touched")},onAttachmentsUploaded:function(b){if(!b)return void this.submitEl.removeClass("btn-loading");for(var c=this.body.formData(),d=0;d<b.length;d++){var e=b[d].name,f=b[d].url;c.append("attachments_url["+d+"][name]",e),c.append("attachments_url["+d+"][url]",f)}apower.productId&&c.append("pro_id",apower.productId);var g=function(a){a&&1==a.status?this.onSubmitted(!0,a.data):this.onSubmitted(!1,a)},h=function(){this.onSubmitted(!1,null)};a.ajax({type:"POST",url:a.nocache("https://support.apowersoft.com/api/support?action=common-submit-ticket"),xhrFields:{withCredentials:!0},data:c,dataType:"json",processData:!1,contentType:!1,crossDomain:!0,success:g.bind(this),error:h.bind(this)})},onSubmitted:function(b,d){this.submitEl.removeClass("btn-loading"),this.body.find("input, textarea").removeClass("touched"),b?(this.body.find("textarea").val(""),this.files=[],this.updateAttachments(),a.msg.success(c("submit_success"))):a.msg.error(c("submit_failed"))},onClickAddFile:function(b){b.preventDefault();var c=a("#support_file_selector");c.length?c.val(""):(c=a('<input id="support_file_selector" type="file" accept="*" multiple hidden>').appendTo("body"),c.$on("change",function(a){for(var b=a.target.files,c=0;c<b.length;c++){var d=b[c];this.files.length<5&&(this.files.push(d),this.updateAttachments())}this.updateAttachments()},this)),c[0].click()},updateAttachments:function(){if(this.fileUl.empty(),this.files.length>0){this.fileWrap.show();for(var b=0;b<this.files.length;b++)this.fileUl.append('<li>{0}<div class="online-form-attachment-close"><i></i><i></i></div></li>'.format(this.files[b].name))}else this.fileWrap.hide();var c=this.baseHeight+40*this.files.length+(this.files.length?10:0);c=Math.min(c,a(window).height()),this.el[0].style.height=c+"px"},onClickFileUl:function(b){if(a(b.target).closest(".online-form-attachment-close").length){var c=a(b.target).closest("li"),d=c.index();this.files.splice(d,1),this.updateAttachments()}}}),a.registerDir("open-online-form",{selector:"[data-open-online-form]",init:function(){this.el.$on("click",this.onClickEl,this)},onClickEl:function(){a.newCom("online-form").show();var b=apower.agents["online-screen-recorder"];b?b.initButton():a.loadScript(apower.getAPIDomain()+"/screen-recorder?apower=1&lang="+apower.lang)}}),a.registerDir("show-online-form",{selector:".online-form-placeholder",init:function(){var b=a.newCom("online-form",{target:null}),c=b.body;c.removeClass("win-body").addClass("online-form").addClass("online-form-placeholder").restoreScroll(),this.el.after(c),this.el.remove();var d=apower.agents["online-screen-recorder"];d?d.initButton():a.loadScript(apower.getAPIDomain()+"/screen-recorder?apower=1&lang="+apower.lang)}}),a.register("load-more",{selector:".load-more",round:1,ref:{btn:"> div",loadEl:"> div > i"},page:1,pagingCount:20,loading:!1,ended:!1,isScrollMode:!1,params:null,url:"",init:function(){if(!this.loadEl.length){var b=this.btn.text();this.btn.empty(),this.loadEl=a('<i><svg viewBox="2 -2 20 20" width="20px" height="20px"><circle class="st0" cx="12" cy="8" r="9"/><path class="st1" d="M12,8"/><circle class="st2" cx="12" cy="8" r="5.5"/><circle class="st3 trail" cx="12" cy="8" r="9"/></svg></i>').appendTo(this.btn),this.btn.append("<span>"+b+"</span>")}this.trail=this.loadEl.find(".trail"),this.isScrollMode?this.initScrollEvents():this.btn.$on("click",this.onClickEl,this)},initScrollEvents:function(){apower.scroller.on("scroll",function(b,c){if("down"===c){var d=Math.max(document.body.scrollHeight-document.body.clientHeight,document.documentElement.scrollHeight-a(document.documentElement).height()),e=this.el.is(":visible");e&&b>=d-30&&this.loadMore()}},this)},onClickEl:function(a){this.loadMore()},loadMore:function(a,b){return this.loading?!1:(a&&b&&(a=a.bind(b)),this.doRequest(a),this.loading=!0,void this.play())},doRequest:function(b){var c=this.url;if(c){var d={page:this.page,count:this.pagingCount};a.extend(d,this.params),a.ajax({type:"GET",xhrFields:{withCredentials:!1},crossDomain:!0,url:a.useParams(c,d),success:this.onLoadSuccess.bind(this,b),error:this.onLoadError.bind(this)})}},onLoadSuccess:function(a,b){if(this.page++,b&&1==b.status){this.loading=!1,this.stop();var c=b.data;this.onData(c),c.length<this.count&&(this.ended=!0,this.el.hide()),apower.offset.update(),a&&a(!0)}else this.onLoadError(),this.ended=!0,this.el.hide(),a&&a(!1)},onLoadError:function(){this.loading=!1,this.stop()},onData:function(a){},play:function(){this.intervalId&&this.stop(),this.playedCount=0,this.intervalId=setInterval(function(){30===++this.playedCount?this.stop():this.playEach()}.bind(this),500),this.playEach()},playedCount:0,playEach:function(){this.round++,this.trail.animate({"stroke-dashoffset":300*-this.round+"%"},1e3,"linear"),this.loadEl.removeClass("paused").addClass("active")},stop:function(){this.intervalId&&(clearInterval(this.intervalId),this.intervalId=0,this.playedCount=0),this.round=1,this.trail.stop(!0),this.trail.css("stroke-dashoffset","-300%"),this.loadEl.removeClass("active").addClass("paused")}}),a.registerDir("font-fit",{selector:"[data-font-fit]",init:function(){this.adjustFontSize(),document.fonts?document.fonts.ready.then(this.adjustFontSize.bind(this)):a.onWinLoaded(this.adjustFontSize,this)},adjustFontSize:function(){this.el.resetFontSizeToBeContained()}}),a.registerDir("text-line",{selector:"[data-text-line]",props:["text-line"],textLine:1,init:function(){this.adjustFontSize(),document.fonts?document.fonts.ready.then(this.adjustFontSize.bind(this)):a.onWinLoaded(this.adjustFontSize,this)},adjustFontSize:function(){this.el.resetFontSizeToBeLine(this.textLine)}}),a.registerDir("multiline-overflow",{selector:"[data-multiline-overflow]",originalText:"",supportsLineClamp:window.CSS&&CSS.supports("display","-webkit-box")&&CSS.supports("-webkit-line-clamp","2"),isAlreadyClamp:!1,init:function(){this.isAlreadyClamp=this.supportsLineClamp&&["-webkit-box","box"].includes(this.el.css("display")),this.originalText=this.el.text(),a(window).width()>768&&(this.addEllipsis(),a(window).$on("resize",a.blockFn(this.updateEllipsis,500),this))},addEllipsis:function(){var a=this.el[0];!this.isAlreadyClamp&&a.clientHeight>0&&a.scrollHeight>a.clientHeight+10&&this.binarySearch()},updateEllipsis:function(){this.el.text(this.originalText),this.addEllipsis()},binarySearch:function(){for(var a=this.el[0],b=this.originalText,c=0,d=b.length-4,e=-1;d>=c;){var f=(c+d)/2;this.el.text(b.slice(0,f)+"...");var g=a.scrollHeight===a.clientHeight;g?(e=f,c=f+1):d=f-1}f!==e&&this.el.text(b.slice(0,e)+"...")},onDestroy:function(){a(window).$off("resize",this.updateEllipsis,this)},cancel:function(){this.el.html(this.originalText)}}),a.registerDir("copy",{selector:"[data-copy]",props:["copy"],copy:"",locked:!1,init:function(){this.copy=this.copy||this.el.text().trim(),this.el.$on("click",this.onClickEl,this)},onClickEl:function(){if(!this.locked){var b=!1;if(document.execCommand&&a(window).width()>768){var d=a('<input style="position: fixed; left: 0; top: 0; z-index: -1;">').appendTo("body");if(d.val(this.copy),d.select(),document.execCommand("copy")){var e=a.newCom("tip",this.el,{tip:c("copied_to_clipboard"),mouseTrigger:!1});e.showTip(),this.locked=!0,b=!0,setTimeout(function(){e.hideTip(),e.destroy(),this.locked=!1}.bind(this),2e3)}d.remove()}b||this.showCopyWin()}},showCopyWin:function(){var b=a.newCom("win",'<div class="win link-win"><div class="win-body">'+this.copy+"</div></div>",{autoDestroy:!0,target:"body"});b.show();var c=document.createRange();c.selectNode(b.el[0]);var d=window.getSelection();d.removeAllRanges(),d.addRange(c)}}),a.registerDir("text-roll",{selector:"[data-text-roll]",props:["text-roll","interval","trigger","scroll-duration"],textRoll:"",trigger:"",scrollDuration:1e3,interval:2e3,timeoutId:0,triggerEl:null,paused:!0,init:function(){this.trigger?"string"==typeof this.trigger?this.triggerEl=this.el.closest(this.trigger):this.triggerEl=a(this.trigger):this.triggerEl=this.el,"auto"===this.textRoll?(this.resumeScroll(),this.triggerEl.$on("mouseenter",this.pauseScroll,this),this.triggerEl.$on("mouseleave",this.resumeScroll,this)):("hover"===this.textRoll||""===this.textRoll)&&(this.triggerEl.$on("mouseenter",this.resumeScroll,this),this.triggerEl.$on("mouseleave",this.pauseScroll,this))},pauseScroll:function(){this.paused=!0,this.timeoutId&&(clearTimeout(this.timeoutId),this.timeoutId=0)},resumeScroll:function(){this.paused=!1,this.timeoutId||this.startNextScroll()},startNextScroll:function(){this.timeoutId=setTimeout(this.scroll.bind(this,!0),this.interval)},scroll:function(){if(!(this.el[0].scrollHeight<=this.el[0].clientHeight)){var a=this.el.children().eq(0),b=a.outerHeight();this.el.animate({scrollTop:b},this.scrollDuration,function(){this.el.append(a),this.el.scrollTop(0),this.paused||this.startNextScroll()}.bind(this))}}}),a.registerDir("toggle-active",{selector:"[data-toggle-active]",props:["toggle-active"],toggleActive:"",init:function(){this.targetEl=a("."+this.toggleActive),this.el.$on("mouseenter",this.onMouseEnter,this),this.el.$on("mouseleave",this.onMouseLeave,this)},onMouseEnter:function(){this.targetEl.addClass("active")},onMouseLeave:function(){this.targetEl.removeClass("active")}}),a.registerDir("scroll-to",{selector:"[data-scroll-to], [data-view]",props:["scroll-to","view"],scrollTo:"",view:"",hasSubHeader:!1,subHeaderHeight:65,init:function(){this.el.$on("click",this.onClickEl,this),this.hasSubHeader=a(".subheader").length>0},onClickEl:function(){var b=this.scrollTo||this.view;if(b){var c=a("."+b);c.length>0&&this.scrollToEl(c)}},scrollToEl:function(b){var c=b.offset().top;this.hasSubHeader&&a(window).width()>768&&c>a(window).height()&&(c-=this.subHeaderHeight),a("html, body").animate({scrollTop:c})}}),a.registerDir("data-href-to",{selector:"[data-href-to]",props:["href-to"],hrefTo:"",init:function(){this.el.$on("click",this.onClickEl,this)},onClickEl:function(b){b.preventDefault();var c=this.hrefTo;if(c){var d=a("#"+c);d.length>0&&this.scrollToEl(d)}},scrollToEl:function(b){var c=b.offset().top,d=Math.max(a(".header").height(),a(".subheader").height());c=c-d-20,window.scrollTo(0,c)}}),a.registerDir("inview",{props:["inview"],inview:.25,selector:".main, .obj-wrap, [data-inview], [data-right-navigation]",init:function(){var a=this.el.is(".main")?0:this.inview,b=this.el.is("[data-right-navigation]"),c=!this.el.is(this.selector.replace(", [data-right-navigation]",""));apower.offset.add({el:this.el,rate:a,isNavigationEl:b,isOnlyNavigationEl:c})}}),apower.offset=a.registerOnce({offsets:[],init:function(){a(window).$on("resize",this.update,this),apower.scroller.on("scroll",a.blockFn(this.onScroll,500),this),a.defer(this.update,this)},lastNavEl:null,onScroll:function(b){for(var c=a(window).height(),d=null,e=0,f=0;f<this.offsets.length;f++){var g=this.offsets[f],h=g.el,i=g.top,j=g.bot,k=g.height,l=g.rate,m=g.isNavigationEl,n=g.isOnlyNavigationEl;if(k){var o=Math.min(j,b+c)-Math.max(i,b),p=0;o>0&&(p=o/Math.min(k,c)),m&&p>e&&(e=p,d=h[0]),p>l?g.inview||(g.inview=!0,
n||h.addClass("inview"),h.$trigger("inview")):g.inview&&(g.inview=!1,n||h.removeClass("inview"),h.$trigger("outview"))}}d!==this.lastNavEl&&(this.trigger("updatenav",d,this.lastNavEl),this.lastNavEl=d)},add:function(b){a.extend(b,{top:0,bot:0,height:0}),this.offsets.push(b)},remove:function(a){for(var b=0;b<this.offsets.length;b++)if(a===this.offsets[b].el)return this.offsets.splice(b,1),!0;return!1},update:function(){for(var b=a("html").scrollTop()||a("body").scrollTop(),c=0;c<this.offsets.length;c++){var d=this.offsets[c],e=d.el,f=e[0].getBoundingClientRect().top+b,g=e[0].offsetHeight;d.top=f,d.bot=g+f,d.height=g,d.inview=!1}this.onScroll(apower.scroller.lastScrollTop)}}),a.registerDir("open-faq",{selector:"[data-open-faq]",init:function(){this.el.$on("click",this.onClickEl,this)},onClickEl:function(a){a.preventDefault();var b=this.el.attr("href");this.openFAQByURL(b)},openFAQWithoutHash:function(){var a=this.el.attr("href");this.openFAQByURL(a.replace(/#.+/,""))},openFAQByURL:function(b){if(b){var c=b.select(/#.+/,0);c&&(b=b.slice(0,-c.length));var d=a.newCom("win",null,{target:"body",autoDestroy:!0,template:'<div class="win faq-win"><iframe class="win-body" style="width: 100%;" src="'+b+'"></iframe></div>'});d.show();var e=this,f=!1,g=!1,h=!1,i=function(){f&&g&&!h&&(e.onIframeReady(d,a(d.body[0].contentDocument),d.body[0].contentWindow,c),h=!0)};a.until(10,function(){return a(d.body[0].contentDocument).find(".counted-share-vertical").length},function(){f=!0,i()}),a.until(10,function(){var b=a(d.body[0].contentDocument).find(".article");return b.length?b:null},function(a){a.onAllImageLoaded(function(){g=!0,i()})}),a(d.body[0].contentWindow).$on("load",function(){g=!0,i()}),d.showLoading()}},onIframeReady:function(a,b,c,d){if(b.find(".header, .counted-share-vertical, .rating-share-section, .posted, .leave-comment, .comment, .yarpp-related, .paging, .aside, .right-bar, .footer").remove(),b.find(".content").css("padding-top","0"),b.find(".content .wrapper").css("max-width","90%").css("padding-bottom","50px"),b.find(".main-content").css("width","auto").css("max-width","none"),a.hideLoading(),d){var e=c.$(d);e.scrollToTop(30,500),setTimeout(function(){e.animate({opacity:.1},300).animate({opacity:1},1e3)},500)}}}),a.registerDir("mobile-zip",{selector:"[data-mobile-zip]",init:function(){window.innerWidth<=768&&this.zip()},zip:function(){var b=this.el.find("tr"),c=b.eq(0).find("th");b.eq(0).remove();for(var d=1;d<b.length;d++){var e=b.eq(d),f=e.find("td");f[0].rowSpan=c.length;for(var g=c.length-1;g>=1;g--){var h=a("<tr></tr>");h.append(c.eq(g).clone()),h.append(f.eq(g)),e.after(h)}}}}),a.registerDir("painting",{selector:".painting",ref:{fitEl:"[data-fit]"},init:function(){var b=this.fitEl.dir("fit");b?b.on("fit",this.adjust,this):this.adjust(),a(window).$on("resize",this.adjust,this)},adjust:function(){window.innerWidth>768&&this.el.each(function(b,c){var d=a(c);this.adjustEachPainting(d)}.bind(this))},cancelLastAdjust:function(a,b){a.css("margin-top",""),b.css("margin-top","")},adjustEachPainting:function(a){var b=a.closest(".wrapper"),c=a.siblings(".writing");if(!(b.length&&b.css("display").includes("flex")||!c[0])){this.cancelLastAdjust(a,c);var d=c.cssNum("margin-top")+c.find("h2").cssNum("margin-top"),e=a.cssNum("margin-top"),f=a.cssNum("margin-bottom"),g=c[0].offsetHeight-c.find("h2").cssNum("margin-top");if(0>f){var h=b.innerHeight(),i=h/2-g/2;c.is("[data-skip-align]")||c.css("margin-top",i)}else{var j=a[0].offsetHeight,k=e+j/2,l=d+g/2;if(Math.abs(k-l)>20)if(k>l){var i=c.cssNum("margin-top")+k-l;c.is("[data-skip-align]")||c.css("margin-top",i)}else{var i=a.cssNum("margin-top")+l-k;a.is("[data-skip-align]")||a.css("margin-top",i)}}}}}),a.registerOnce("[data-right-navigation]",{lastScrollDirection:"",ref:{rightEl:".right-navigation",rightBtns:".right-navigation li"},init:function(){this.rightEl=a(".right-navigation"),this.rightBtns=a(".right-navigation li"),this.subheader=a(".subheader"),this.rightBtns.$on("click",this.onClickBtn,this),apower.offset.on("updatenav",this.onUpdateNav,this);var b=this.rightEl.height()==window.innerHeight;window.innerWidth>768&&this.subheader.length&&b&&(this.rightEl.$on("mouseenter",this.onRightElMouseEnter,this),this.rightEl.$on("mouseleave",this.onRightElMouseLeave,this))},onRightElMouseEnter:function(){this.subheader.addClass("shade-by-rightnav")},onRightElMouseLeave:function(){this.subheader.removeClass("shade-by-rightnav")},onUpdateNav:function(a,b){if(a){var c=this.el.indexOf(a),d=/\s*(?:-?screen|function|inview|active)\s*/g,e=a.className.replace(d,""),f=b?b.className.replace(d,""):"";this.rightBtns.removeClass("active"),this.rightBtns.eq(c).addClass("active"),this.rightEl.removeClass("data-right-"+f),this.rightEl.addClass("data-right-"+e),this.rightEl.show()}else this.rightEl.hide()},onClickBtn:function(b){var c=a(b.target).closest("li"),d=c.index(),e=this.el.eq(d);a.com("scroll-to").prototype.scrollToEl.call(this,e)}}),a.registerDir("object-fit",{selector:"[data-object-fit]",props:["object-fit"],objectFit:"cover",videoWidth:0,videoHeight:0,init:function(){this.objectFit=this.objectFit||"cover",this.el.$on("loadedmetadata",this.adjustVideoBox,this),a(window).$on("resize",this.adjustVideoBox,this)},onDestroy:function(){a(window).$off("resize",this.adjustVideoBox,this)},adjustVideoBox:function(){var a=this.el[0],b=a.videoWidth,c=a.videoHeight,d=a.parentNode.clientWidth,e=a.parentNode.clientHeight;if(b&&c&&d&&e&&"cover"===this.objectFit)if(b/c>d/e){var f=e,g=b/c*e;this.el.css("left",d/2-g/2),this.el.css("width",g),this.el.css("height",f)}else this.el.css("left",""),this.el.css("width",""),this.el.css("height","")}}),a.registerDir("download-stats",{selector:"[data-download-stats]",props:["download-stats"],downloadStats:"",init:function(){this.downloadStats||(this.downloadStats=(a("a.download, a[data-download-url]").attr("href")||"").replace(/^.+down\.php/,"https://download.apowersoft.com/stats")),this.downloadStats&&a.ajax({type:"GET",url:this.downloadStats,dataType:"json",success:this.updateDownloadCount.bind(this)})},updateDownloadCount:function(a){var b=a.count;if(b>0){b=String(b);var c=(b.length-1)%3+1;b=b.slice(0,c)+b.slice(c).replace(/\d\d\d/g,",$&"),this.el.text(b)}}}),a.registerDir("bgdelay",{selector:".bgdelay",init:function(){apower.scroller.on("down",this.onScrollDown,this)},onScrollDown:function(b){this.el.offset().top-b<=a(window).height()&&this.el.removeClass("bgdelay")}})}(jQuery);